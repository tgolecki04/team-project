ggplot(aes(y = age, color = currentSmoker)) +
geom_boxplot() +
theme_ipsum_rc()
p2 <- badania |>
ggplot(aes(x = age)) +
geom_density() +
theme_ipsum_rc()
p1; p2
p1 <- badania |>
ggplot(aes(y = age, color = currentSmoker)) +
geom_boxplot() +
theme_ipsum_rc()
p2 <- badania |>
ggplot(aes(x = age, color = currentSmoker)) +
geom_density() +
theme_ipsum_rc()
p1; p2
#| warning: false
p <- badania |>
ggplot(aes(x = heartRate, fill = TenYearCHD)) +
geom_histogram(binwidth = 5) +
theme_ipsum_rc() +
scale_fill_manual(values = c("#6AAED9", "#F2A391"))
p
#| warning: false
p1 <- badania |>
ggplot(aes(x = sysBP, color = TenYearCHD)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p2 <- badania |>
ggplot(aes(x = diaBP, color = TenYearCHD)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
#| warning: false
p1 <- badania |>
ggplot(aes(x = sysBP, color = TenYearCHD)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p2 <- badania |>
ggplot(aes(x = diaBP, color = TenYearCHD)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
#| warning: false
p1 <- badania |>
ggplot(aes(x = sysBP, color = TenYearCHD)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p2 <- badania |>
ggplot(aes(x = diaBP, color = TenYearCHD)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
#| warning: false
p1 <- badania |>
ggplot(aes(x = sysBP, color = TenYearCHD)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p2 <- badania |>
ggplot(aes(x = diaBP, color = TenYearCHD)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
#| warning: false
p1 <- badania |>
ggplot(aes(x = TenYearCHD, y = sysBP, color = sex)) +
geom_boxplot() +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p2 <- badania |>
ggplot(aes(x = TenYearCHD, y = diaBP, color = sex)) +
geom_boxplot() +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
#| warning: false
p1 <- badania |>
ggplot(aes(x = TenYearCHD, y = sysBP, color = sex)) +
geom_boxplot() +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p2 <- badania |>
ggplot(aes(x = TenYearCHD, y = diaBP, color = sex)) +
geom_boxplot() +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p1; p2
#| warning: false
p1 <- badania |>
ggplot(aes(y = age, color = currentSmoker)) +
geom_boxplot() +
theme_ipsum_rc()
p2 <- badania |>
ggplot(aes(x = age, color = currentSmoker)) +
geom_density() +
theme_ipsum_rc()
p1; p2
cor_mat <- badania %>%
select(where(is.numeric)) %>%
cor()
p <- ggcorrplot(
cor_mat,
lab = TRUE,
type = "lower",
hc.order = TRUE,          #
outline.col = "white",
ggtheme = ggplot2::theme_minimal(),
colors = c("#6AAED9", "white", "#F25041")
)
ggsave("images/plots/macierz_korelacji.jpg", p)
#| echo: false
#| output: false
library(readr)
library(skimr)
library(knitr)
library(tidyverse)
library(corrplot)
library(ggcorrplot)
library(ggthemes)
library(tinythemes)
library(kableExtra)
library(rlang)
library(gridExtra)
library(patchwork)
library(mice)
library(psych)
data <- read.csv2("data/badania.csv", sep=",")
head(data)
tail(data)
nrow(data)
ncol(data)
colnames(data)
skim(data)
badania <- data |>
mutate(
sysBP = as.numeric(sysBP),
diaBP = as.numeric(diaBP),
BMI = as.numeric(BMI),
sex = factor(male, levels = c(0, 1), labels = c("Female", "Male")),
education = factor(education, ordered = TRUE),
currentSmoker = factor(currentSmoker, labels = c("No", "Yes")),
BPMeds = factor(BPMeds, labels = c("No", "Yes")),
prevalentStroke = factor(prevalentStroke, labels = c("No", "Yes")),
prevalentHyp = factor(prevalentHyp, labels = c("No", "Yes")),
diabetes = factor(diabetes, labels = c("No", "Yes")),
TenYearCHD = factor(TenYearCHD, labels = c("No", "Yes"))
) |> dplyr::select(-male)
badania <- badania[order(is.na(badania$glucose), decreasing = TRUE), ]
badania <- dplyr::select(badania, c(1, 16, 2, 10, 11, 13, 12, 9, 14, 8, 4, 3, 5:7, 15))
head(badania)
#| warning: false
NA_count <- colSums(is.na(badania))[colSums(is.na(badania)) > 0] |>
data.frame()
names(NA_count) <- "count"
NA_count$var = rownames(NA_count)
rownames(NA_count) <- NULL
NA_count <- select(NA_count, c(2,1))
p <- ggplot(NA_count, aes(x = var, y = count, fill = "#fc9d03")) +
geom_col(show.legend = FALSE) +
theme_ipsum_rc() +
geom_text(aes(label = count), vjust = -0.5) +
expand_limits(y = max(NA_count$count) * 1.1) +
labs(title = "Liczba wartości NA w zmiennych")
ggsave("images/plots/na_count_before.png", p)
NA_df <- data.frame(NA_w_wierszu = rowSums(is.na(badania))) |>
group_by(NA_w_wierszu) |>
summarise(liczebnosc = n())
p <- NA_df |> ggplot(aes(NA_w_wierszu, liczebnosc, fill = "#fc9d03")) +
geom_col(show.legend = FALSE) +
theme_ipsum_rc() +
geom_text(aes(label = liczebnosc), vjust = -0.5) +
expand_limits(y = max(NA_df$liczebnosc) * 1.1) +
labs(title = "Liczba wartości NA w rekordach")
ggsave("images/plots/NA_count_perRow.png", p)
badania <- badania[rowSums(is.na(badania)) <= 1, ]
#| warning: false
#| echo: false
NA_count <- colSums(is.na(badania))[colSums(is.na(badania)) > 0] |>
data.frame()
names(NA_count) <- "count"
NA_count$var = rownames(NA_count)
rownames(NA_count) <- NULL
NA_count <- select(NA_count, c(2,1))
p <- ggplot(NA_count, aes(x = var, y = count, fill = "#fc9d03")) +
geom_col(show.legend = FALSE) +
theme_ipsum_rc() +
geom_text(aes(label = count), vjust = -0.5) +
expand_limits(y = max(NA_count$count) * 1.1) +
labs(title = "Liczba wartości NA w zmiennych")
ggsave("images/plots/na_count_after.png", p)
#| output: false
statystyki_przed <- describe(badania[NA_count$var])
metody <- make.method(badania)
metody["BPMeds"] <- "logreg"        #
metody["education"] <- "polr"
metody["BMI"] <- "pmm"
metody["cigsPerDay"] <- "pmm"
metody["glucose"] <- "pmm"
metody["heartRate"] <- "pmm"
metody["totChol"] <- "pmm"
uzupelnienia <- mice(badania,
m = 5,
method = metody,
seed = 2025)
badania <- complete(uzupelnienia)
statystyki_po <- describe(badania[NA_count$var])
round(data.frame(t(statystyki_przed))[c(2:9,10:12), ], 3)
round(data.frame(t(statystyki_po))[c(2:8,10:12), ], 3)
badania <- mutate(badania, ID = 1:nrow(badania))
zdrowi <- badania |>
subset(TenYearCHD == "No")
chorzy <- badania |>
subset(TenYearCHD == "Yes")
#| warning: false
zmienna_wykres <- function(dane, typ_zmiennej, typ_wykresu) {
my_plots = list()
if (typ_zmiennej == "kategoryczna") {
dane <- dane |>
dplyr::select(where(is.factor))
} else if (typ_zmiennej == "numeryczna") {
dane <- dane |>
dplyr::select(where(is.numeric))
} else {
# nic nie robimy
}
for (i in 1:ncol(dane)) {
kolumna <- colnames(dane)[i]
if (typ_wykresu == "barplot") {
p <- ggplot(dane, aes(x = !!sym(kolumna), fill = !!sym(kolumna))) +
geom_bar(show.legend = FALSE) +
theme_ipsum_rc() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else if (typ_wykresu == "pie") {
p <- dane %>%
dplyr::count(!!sym(kolumna)) %>%
ggplot(aes(x = "", y = n, fill = !!sym(kolumna))) +
geom_bar(stat = "identity", width = 1, color = "white") +
coord_polar(theta = "y") +
theme_void() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else if (typ_wykresu == "histogram") {
p <- ggplot(dane, aes(x = !!sym(kolumna))) +
geom_histogram(bins = 20, show.legend = FALSE, fill = "#6AAED9") +
theme_ipsum_rc() +
ggtitle(kolumna)
} else if (typ_wykresu == "violin") {
p <- ggplot(dane, aes(x = "", y = !!sym(kolumna), fill = "#6AAED9")) +
geom_violin(show.legend = FALSE) +
theme_ipsum_rc() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else {
next  # pomiń jeśli nieznany typ wykresu
}
my_plots[[i]] <- p
}
gotowy_wykres_1 <- (my_plots[[1]] + my_plots[[2]]) / (my_plots[[3]] + my_plots[[4]])
gotowy_wykres_2 <- (my_plots[[5]] + my_plots[[6]]) / (my_plots[[7]] + my_plots[[8]])
ggsave(paste0("images/plots/", typ_zmiennej, "_", typ_wykresu, "1.png"), gotowy_wykres_1)
ggsave(paste0("images/plots/", typ_zmiennej, "_", typ_wykresu, "2.png"), gotowy_wykres_2)
}
zmienna_wykres(badania, "kategoryczna", "barplot")
zmienna_wykres(badania, "kategoryczna", "pie")
zmienna_wykres(badania, "numeryczna", "violin")
zmienna_wykres(badania, "numeryczna", "histogram")
cor_mat <- badania %>%
select(where(is.numeric)) %>%
cor()
p <- ggcorrplot(
cor_mat,
lab = TRUE,
type = "lower",
hc.order = TRUE,          #
outline.col = "white",
ggtheme = ggplot2::theme_minimal(),
colors = c("#6AAED9", "white", "#F25041")
)
ggsave("images/plots/macierz_korelacji.jpg", p)
p1 <- ggplot(badania, aes(x = diaBP, y = sysBP, color = sex, shape = sex)) +
geom_point() +
theme_ipsum_rc() +
ggtitle("sysBP ~ diaBP") +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
theme(legend.position = "bottom")
ggsave("images/plots/sysBP_diaBP_bySex_point.jpg", p1)
p1 <- ggplot(badania, aes(x = diaBP, color = sex)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("sysBP ~ diaBP") +
scale_color_manual(values = c("#6AAED9", "#F2A391")) +
theme(legend.position = "bottom")
p2 <- ggplot(badania, aes(x = diaBP, color = education)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("sysBP ~ diaBP") +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
theme(legend.position = "bottom")
p3 <- ggplot(badania, aes(x = diaBP, color = currentSmoker)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("sysBP ~ diaBP") +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
theme(legend.position = "bottom")
ggsave("images/plots/diaBP_bySex.jpg", p1)
ggsave("images/plots/diaBP_byEducation.jpg", p2)
ggsave("images/plots/diaBP_byCurrentSmoker.jpg", p3)
p1 <- ggplot(badania, aes(x = sysBP, color = sex)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("sysBP ~ diaBP") +
scale_color_manual(values = c("#6AAED9", "#F2A391")) +
theme(legend.position = "bottom")
p2 <- ggplot(badania, aes(x = sysBP, color = education)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("sysBP ~ diaBP") +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
theme(legend.position = "bottom")
p3 <- ggplot(badania, aes(x = sysBP, color = currentSmoker)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("sysBP ~ diaBP") +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
theme(legend.position = "bottom")
ggsave("images/plots/sysBP_bySex.jpg", p1)
ggsave("images/plots/sysBP_byEducation.jpg", p2)
ggsave("images/plots/sysBP_byCurrentSmoker.jpg", p3)
p <- badania |>
mutate(range_diff = sysBP - diaBP) |>
arrange(range_diff) |>
ggplot(aes(x = range_diff, color = TenYearCHD)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
ggsave("images/plots/range_density.jpg", p)
#| warning: false
p1 <- badania |>
ggplot(aes(x = TenYearCHD, y = sysBP, color = sex)) +
geom_boxplot() +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p2 <- badania |>
ggplot(aes(x = TenYearCHD, y = diaBP, color = sex)) +
geom_boxplot() +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p1; p2
#| warning: false
p1 <- badania |>
ggplot(aes(x = sysBP, color = TenYearCHD)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p2 <- badania |>
ggplot(aes(x = diaBP, color = TenYearCHD)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
#| warning: false
p <- badania |>
ggplot(aes(x = heartRate, fill = TenYearCHD)) +
geom_histogram(binwidth = 5) +
theme_ipsum_rc() +
scale_fill_manual(values = c("#6AAED9", "#F2A391"))
p
#| warning: false
p <- badania |>
ggplot(aes(x = heartRate)) +
geom_density(color = "#6AAED9", lwd = 1.2) +
stat_function(
fun = dnorm,
args = list(mean = mean(badania$heartRate), sd = sd(badania$heartRate)),
linewidth = 1.2,
col = "#F25041"
) +
theme_ipsum_rc()
p
#| warning: false
p1 <- badania |>
ggplot(aes(x = TenYearCHD, y = heartRate, color = sex)) +
geom_boxplot() +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p2 <- badania |>
ggplot(aes(x = TenYearCHD, y = heartRate, color = currentSmoker)) +
geom_boxplot() +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p3 <- badania |>
ggplot(aes(x = TenYearCHD, y = heartRate, color = BPMeds)) +
geom_boxplot() +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p1; p2; p3
#| warning: false
p1 <- badania |>
ggplot(aes(x = sysBP, color = BPMeds)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p2 <- badania |>
ggplot(aes(x = diaBP, color = BPMeds)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p1;p2
osoby_palace <- badania |>
subset(currentSmoker == "Yes")
osoby_niepalace <- badania |>
subset(cigsPerDay == 0)
nrow(osoby_palace)
nrow(osoby_niepalace)
#| warning: false
p1 <- badania |>
ggplot(aes(x = currentSmoker, fill = currentSmoker)) +
geom_bar(fill = c("#6AAED9", "#F2A391"), width = 0.4) +
theme_ipsum_rc()
p2 <- badania |>
ggplot(aes(x = currentSmoker, fill = sex)) +
geom_bar(position = "dodge") +
theme_ipsum_rc() +
scale_fill_manual(values = c("#6AAED9", "#F2A391"))
p3 <- badania |>
ggplot(aes(x = currentSmoker, fill = TenYearCHD)) +
geom_bar(position = "dodge") +
theme_ipsum_rc() +
scale_fill_manual(values = c("#6AAED9", "#F2A391"))
p1; p2; p3
#| warning: false
p1 <- badania |>
ggplot(aes(x = cigsPerDay)) +
geom_bar(fill = "#6AAED9") +
theme_ipsum_rc()
p2 <- osoby_palace |>
ggplot(aes(x = cigsPerDay)) +
geom_bar(fill = "#6AAED9") +
theme_ipsum_rc()
p1; p2
#| warning: false
paczki <- badania |>
group_by(cigsPerDay, TenYearCHD) |>
summarise(n = n(), .groups = "drop") |>
group_by(cigsPerDay) |>
mutate(perc = n / sum(n) * 100)
p1 <- paczki[1:28, ] |>
ggplot(aes(x = factor(cigsPerDay), y = n, fill = factor(TenYearCHD))) +
geom_col(position = position_dodge(width = 0.8)) +
labs(
x = "Cigarettes per Day",
y = "Liczba osób",
fill = "TenYearCHD"
) +
theme_ipsum_rc() +
scale_fill_manual(values = c("#6AAED9", "#F2A391"))
p2 <- paczki[3:28, ] |>
ggplot(aes(x = factor(cigsPerDay), y = n, fill = factor(TenYearCHD))) +
geom_col(position = position_dodge(width = 0.8)) +
labs(
x = "Cigarettes per Day",
y = "Liczba osób",
fill = "TenYearCHD"
) +
theme_ipsum_rc() +
scale_fill_manual(values = c("#6AAED9", "#F2A391"))
p3 <- paczki[29:nrow(paczki), ] |>
ggplot(aes(x = factor(cigsPerDay), y = n, fill = factor(TenYearCHD))) +
geom_col(position = position_dodge(width = 0.8)) +
labs(
x = "Cigarettes per Day",
y = "Liczba osób",
fill = "TenYearCHD"
) +
theme_ipsum_rc() +
scale_fill_manual(values = c("#6AAED9", "#F2A391"))
p1; p2; p3
#| warning: false
p1 <- paczki[1:28, ] |>
ggplot(aes(x = factor(cigsPerDay),
y = perc,
fill = factor(TenYearCHD)
)) +
geom_col(position = position_dodge(width = 0.8)) +
labs(
x = "Cigarettes per Day",
y = "Procent",
fill = "Ten-Year CHD"
) +
theme_ipsum_rc() +
scale_fill_manual(values = c("#6AAED9", "#F2A391"))
p1
#| warning: false
p1 <- badania |>
ggplot(aes(y = age, color = currentSmoker)) +
geom_boxplot() +
theme_ipsum_rc()
p2 <- badania |>
ggplot(aes(x = age, color = currentSmoker)) +
geom_density() +
theme_ipsum_rc()
p1; p2
setwd("C:/Users/Tomasz04/Desktop/Workspace/STUDIA/team-project")
#| warning: false
p1 <- badania |>
ggplot(aes(x = currentSmoker)) +
geom_bar() +
theme_ipsum_rc()
