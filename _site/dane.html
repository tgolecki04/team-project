<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tomasz Golecki | Tomasz Hanusek | Damian Spodar">
<meta name="dcterms.date" content="2025-12-12">

<title>Wczesne Wykrywanie Ryzyka Zawału Serca</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./wizualizacje.html" rel="next">
<link href="./plan.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-769c07d0e25390bffab1c8e68d961bd8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-0c847a68207458de495b48638e8b7100.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-769c07d0e25390bffab1c8e68d961bd8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: #fcfffd;
      }

      .quarto-title-block .quarto-title-banner {
        color: #fcfffd;
background: #947E76;
      }
</style>
<link rel="icon" type="image/x-icon" href="images/favicon/favicon.ico">

<link rel="shortcut icon" href="images/favicon/favicon.ico">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> <i class="bi bi-box-seam" role="img">
</i> 
<span class="menu-text">Strona Główna</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./aplikacja.html"> <i class="bi bi-code-slash" role="img">
</i> 
<span class="menu-text">Aplikacja</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./sprawozdanie.html"> <i class="bi bi-book" role="img">
</i> 
<span class="menu-text">Sprawozdanie</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.kaggle.com/datasets/noeyislearning/framingham-heart-study"> <i class="bi bi-database" role="img">
</i> 
<span class="menu-text">Dataset</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://pollub.pl/"> <i class="bi bi-rocket-takeoff" role="img">
</i> 
<span class="menu-text">Politechnika Lubelska</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./kontakt.html"> <i class="bi bi-people" role="img">
</i> 
<span class="menu-text">Kontakt</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="./#"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./dane.html">2. Dane</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Wczesne Wykrywanie Ryzyka Zawału Serca</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
            <p class="subtitle lead">Zapoznanie I Praca Z Danymi</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Tomasz Golecki | Tomasz Hanusek | Damian Spodar </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 12, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/article/logo_pollub.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wstęp</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./plan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Plan Projektu</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dane.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">2. Dane</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wizualizacje.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Wizualizacje</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modele.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Modele</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wnioski.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Wnioski</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./zakonczenie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Zakończenie</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literatura.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatura</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Spis treści</h2>
   
  <ul>
  <li><a href="#rozpoczęcie" id="toc-rozpoczęcie" class="nav-link active" data-scroll-target="#rozpoczęcie"><span class="header-section-number">1</span> Rozpoczęcie</a>
  <ul class="collapse">
  <li><a href="#biblioteki" id="toc-biblioteki" class="nav-link" data-scroll-target="#biblioteki"><span class="header-section-number">1.1</span> Biblioteki</a></li>
  <li><a href="#zapoznanie-z-danymi" id="toc-zapoznanie-z-danymi" class="nav-link" data-scroll-target="#zapoznanie-z-danymi"><span class="header-section-number">1.2</span> Zapoznanie z danymi</a></li>
  <li><a href="#opis-i-wyjaśnienie-zmiennych" id="toc-opis-i-wyjaśnienie-zmiennych" class="nav-link" data-scroll-target="#opis-i-wyjaśnienie-zmiennych"><span class="header-section-number">1.3</span> Opis i wyjaśnienie zmiennych</a></li>
  <li><a href="#uzupełnienie-brakujących-wartości" id="toc-uzupełnienie-brakujących-wartości" class="nav-link" data-scroll-target="#uzupełnienie-brakujących-wartości"><span class="header-section-number">1.4</span> Uzupełnienie brakujących wartości</a></li>
  <li><a href="#wstępna-analiza" id="toc-wstępna-analiza" class="nav-link" data-scroll-target="#wstępna-analiza"><span class="header-section-number">1.5</span> Wstępna Analiza</a></li>
  <li><a href="#relacja-pomiędzy-zmienną-age-a-zmienną-cigsperday" id="toc-relacja-pomiędzy-zmienną-age-a-zmienną-cigsperday" class="nav-link" data-scroll-target="#relacja-pomiędzy-zmienną-age-a-zmienną-cigsperday"><span class="header-section-number">1.6</span> Relacja pomiędzy zmienną <code>age</code>, a zmienną <code>cigsPerDay</code></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">






<section id="rozpoczęcie" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="rozpoczęcie"><span class="header-section-number">1</span> Rozpoczęcie</h2>
<p>Lorem ipsum dolor sit amet consectetur adipiscing elit quisque faucibus ex sapien vitae pellentesque sem placerat in id cursus mi pretium tellus duis convallis tempus leo eu aenean sed diam urna tempor pulvinar vivamus fringilla lacus nec metus bibendum egestas iaculis massa nisl malesuada lacinia integer nunc posuere ut hendrerit semper vel class aptent taciti sociosqu ad litora torquent per conubia nostra inceptos himenaeos orci varius natoque penatibus et magnis dis parturient montes nascetur ridiculus mus donec rhoncus eros lobortis nulla molestie mattis scelerisque maximus eget fermentum odio phasellus non purus est efficitur laoreet mauris pharetra vestibulum fusce dictum risus blandit quis suspendisse aliquet nisi sodales consequat magna ante condimentum neque at luctus nibh finibus facilisis dapibus etiam interdum tortor ligula congue sollicitudin erat viverra ac tincidunt nam porta elementum a enim euismod quam justo lectus commodo augue arcu dignissim velit aliquam imperdiet mollis nullam volutpat porttitor ullamcorper rutrum gravida cras eleifend turpis fames primis vulputate ornare sagittis vehicula praesent dui felis.</p>
<section id="biblioteki" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="biblioteki"><span class="header-section-number">1.1</span> Biblioteki</h3>
</section>
<section id="zapoznanie-z-danymi" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="zapoznanie-z-danymi"><span class="header-section-number">1.2</span> Zapoznanie z danymi</h3>
<p>Wczytanie pliku z rozszerzeniem <code>csv</code> do zmiennej o nazwie <code>data</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">"data/badania.csv"</span>, <span class="at">sep=</span><span class="st">","</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Sprawdźmy jak wyglądają nasze dane. Użyjemy do tego funkcji <code>head()</code> oraz <code>tail()</code> do podglądu kilku pierwszych i ostatnich obserwacji w naszym zbiorze danych. Pierwsze 10 obserwacji ma postać:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">male</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">education</th>
<th style="text-align: right;">currentSmoker</th>
<th style="text-align: right;">cigsPerDay</th>
<th style="text-align: right;">BPMeds</th>
<th style="text-align: right;">prevalentStroke</th>
<th style="text-align: right;">prevalentHyp</th>
<th style="text-align: right;">diabetes</th>
<th style="text-align: right;">totChol</th>
<th style="text-align: left;">sysBP</th>
<th style="text-align: left;">diaBP</th>
<th style="text-align: left;">BMI</th>
<th style="text-align: right;">heartRate</th>
<th style="text-align: right;">glucose</th>
<th style="text-align: right;">TenYearCHD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">195</td>
<td style="text-align: left;">106</td>
<td style="text-align: left;">70</td>
<td style="text-align: left;">26.97</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">250</td>
<td style="text-align: left;">121</td>
<td style="text-align: left;">81</td>
<td style="text-align: left;">28.73</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">245</td>
<td style="text-align: left;">127.5</td>
<td style="text-align: left;">80</td>
<td style="text-align: left;">25.34</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">225</td>
<td style="text-align: left;">150</td>
<td style="text-align: left;">95</td>
<td style="text-align: left;">28.58</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">285</td>
<td style="text-align: left;">130</td>
<td style="text-align: left;">84</td>
<td style="text-align: left;">23.1</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">228</td>
<td style="text-align: left;">180</td>
<td style="text-align: left;">110</td>
<td style="text-align: left;">30.3</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">99</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Natomiast kilka ostatnich obserwcji nad którymi bedziemy pracować mają postać:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">male</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">education</th>
<th style="text-align: right;">currentSmoker</th>
<th style="text-align: right;">cigsPerDay</th>
<th style="text-align: right;">BPMeds</th>
<th style="text-align: right;">prevalentStroke</th>
<th style="text-align: right;">prevalentHyp</th>
<th style="text-align: right;">diabetes</th>
<th style="text-align: right;">totChol</th>
<th style="text-align: left;">sysBP</th>
<th style="text-align: left;">diaBP</th>
<th style="text-align: left;">BMI</th>
<th style="text-align: right;">heartRate</th>
<th style="text-align: right;">glucose</th>
<th style="text-align: right;">TenYearCHD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">4235</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">207</td>
<td style="text-align: left;">126.5</td>
<td style="text-align: left;">80</td>
<td style="text-align: left;">19.71</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">4236</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">248</td>
<td style="text-align: left;">131</td>
<td style="text-align: left;">72</td>
<td style="text-align: left;">22</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4237</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">210</td>
<td style="text-align: left;">126.5</td>
<td style="text-align: left;">87</td>
<td style="text-align: left;">19.16</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">4238</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">269</td>
<td style="text-align: left;">133.5</td>
<td style="text-align: left;">83</td>
<td style="text-align: left;">21.47</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4239</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">185</td>
<td style="text-align: left;">141</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;">25.6</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">4240</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">196</td>
<td style="text-align: left;">133</td>
<td style="text-align: left;">86</td>
<td style="text-align: left;">20.91</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Spradźmy rozmiary naszej ramki danych. W tym celu posłużymy się funkcjami <code>nrow()</code> oraz <code>ncol()</code>, które zawracają odpowiednio <strong>liczbę wierszy</strong> oraz <strong>liczbę kolumn</strong>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4240</code></pre>
</div>
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16</code></pre>
</div>
</div>
<p>Widzimy że mamy ponad 4200 obserwacji i 16 zmiennych, które posłużą nam do stworzenia kilku modeli predykcyjnych i wyboru tego, który najlepiej będzie oceniał ryzyko zawału serca. Jest to naprawdę duży zasób danych, które mogą odpowiedzieć na wiele interesujących pytań. Nadszedł czas sprawdzić zmienne, które posiadamy. Użyjemy do tego funkcji <code>colnames().</code></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "male"            "age"             "education"       "currentSmoker"  
 [5] "cigsPerDay"      "BPMeds"          "prevalentStroke" "prevalentHyp"   
 [9] "diabetes"        "totChol"         "sysBP"           "diaBP"          
[13] "BMI"             "heartRate"       "glucose"         "TenYearCHD"     </code></pre>
</div>
</div>
<p>Okazuje się, że nasz zbiór zawiera cenne informacje medyczne takie jak:</p>
<ol type="1">
<li><p>Tętno</p></li>
<li><p>BMI</p></li>
<li><p>Ciśnienie skurczowe i rozkurczowe</p></li>
<li><p>Poziom cholesterolu i glukozy</p></li>
<li><p>Informacje o tym, czy pacjent był palaczem, czy też nie</p></li>
</ol>
<p>Dokładniej przyjrzymy się naszym zmiennym w dalszej części analizy zbioru danych. Wyjaśnimy dokładniej cechy poszczególnych kolumn zbioru danych oraz ich podstawowe statystyki. Czas sprawdzić podstawowe statystki dotyczące danych oraz to z jakimi typami danych będziemy pracować.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">data</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">4240</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sysBP</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">234</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">diaBP</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">146</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1364</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">49.58</td>
<td style="text-align: right;">8.57</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">70</td>
<td style="text-align: left;">▃▇▆▆▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">1.98</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">▇▆▁▃▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">currentSmoker</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cigsPerDay</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">9.01</td>
<td style="text-align: right;">11.92</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">70</td>
<td style="text-align: left;">▇▃▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">BPMeds</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prevalentStroke</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">prevalentHyp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">diabetes</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">totChol</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">236.70</td>
<td style="text-align: right;">44.59</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">206</td>
<td style="text-align: right;">234</td>
<td style="text-align: right;">263</td>
<td style="text-align: right;">696</td>
<td style="text-align: left;">▆▇▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">heartRate</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">75.88</td>
<td style="text-align: right;">12.03</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">143</td>
<td style="text-align: left;">▂▇▃▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">glucose</td>
<td style="text-align: right;">388</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">81.96</td>
<td style="text-align: right;">23.95</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">78</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">394</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TenYearCHD</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Tak jak widać na powyższym raporcie, zaczytując dane otrzymujemy 3 zmienne typu <code>character</code> oraz 13 zmiennych typu <code>numeric</code>. Taki podział ze względu na typ zmiennych nie jest odpowiedni. Wszystkie cechy typu <code>character</code> mają w naszym przypadku błędne formatowanie. Dodatkowo będziemy musieli dodać nowe typy zmiennych takie jak <code>boolean</code> oraz <code>factor</code>, aby móc szybko i praktycznie pracować z danymi. Odpowiedni wybór typów zmiennych jest podstawowym krokiem rozpczynając analizę zbioru danych. Zrobimy to w następujący sposób.</p>
<p>badania_sorted &lt;- badania[order(is.na(badania$glucose), decreasing = TRUE), ]</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sysBP =</span> <span class="fu">as.numeric</span>(sysBP),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">diaBP =</span> <span class="fu">as.numeric</span>(diaBP),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">BMI =</span> <span class="fu">as.numeric</span>(BMI),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">factor</span>(male, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>)),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">education =</span> <span class="fu">factor</span>(education, <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">currentSmoker =</span> <span class="fu">factor</span>(currentSmoker, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">BPMeds =</span> <span class="fu">factor</span>(BPMeds, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">prevalentStroke =</span> <span class="fu">factor</span>(prevalentStroke, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">prevalentHyp =</span> <span class="fu">factor</span>(prevalentHyp, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">diabetes =</span> <span class="fu">factor</span>(diabetes, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">TenYearCHD =</span> <span class="fu">factor</span>(TenYearCHD, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>))</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>male)   </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> badania[<span class="fu">order</span>(<span class="fu">is.na</span>(badania<span class="sc">$</span>glucose), <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>W tym momencie wszystkie zmienne mają przypisane odpowiednie typy danych, co pozwoli zaoszczędzić czas podczas przeprowadzania obliczeń i analizy nad nimi. Dla wygody uporządkujemy teraz kolumny w odpowiedniej dla nas kolejności, tak aby informacje powiązane ze sobą były obok siebie (Np. zmienna <code>glucose</code> obok zmiennej <code>diabetes</code>)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(badania, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>, <span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">14</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">15</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(badania)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">age</th>
<th style="text-align: left;">sex</th>
<th style="text-align: left;">education</th>
<th style="text-align: right;">sysBP</th>
<th style="text-align: right;">diaBP</th>
<th style="text-align: right;">heartRate</th>
<th style="text-align: right;">BMI</th>
<th style="text-align: right;">totChol</th>
<th style="text-align: right;">glucose</th>
<th style="text-align: left;">diabetes</th>
<th style="text-align: right;">cigsPerDay</th>
<th style="text-align: left;">currentSmoker</th>
<th style="text-align: left;">BPMeds</th>
<th style="text-align: left;">prevalentStroke</th>
<th style="text-align: left;">prevalentHyp</th>
<th style="text-align: left;">TenYearCHD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">15</td>
<td style="text-align: right;">39</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">114.0</td>
<td style="text-align: right;">64.0</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">22.35</td>
<td style="text-align: right;">226</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">22</td>
<td style="text-align: right;">43</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">123.5</td>
<td style="text-align: right;">77.5</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">29.89</td>
<td style="text-align: right;">185</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">27</td>
<td style="text-align: right;">60</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">110.0</td>
<td style="text-align: right;">72.5</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">26.59</td>
<td style="text-align: right;">260</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">43</td>
<td style="text-align: right;">52</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">148.0</td>
<td style="text-align: right;">92.0</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">25.09</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">55</td>
<td style="text-align: right;">39</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">115.0</td>
<td style="text-align: right;">75.0</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">22.54</td>
<td style="text-align: right;">209</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">71</td>
<td style="text-align: right;">63</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">164.5</td>
<td style="text-align: right;">76.0</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">29.35</td>
<td style="text-align: right;">248</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Zrobione. Teraz możemy przejść do wyjaśnienia zmiennych, aby było jasne z czym pracujemy oraz na czym możemy polegać podczas wykonywania analizy.</p>
</section>
<section id="opis-i-wyjaśnienie-zmiennych" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="opis-i-wyjaśnienie-zmiennych"><span class="header-section-number">1.3</span> Opis i wyjaśnienie zmiennych</h3>
<p>Poniżej znajduje się tabela zawierająca wszystkie cechy wraz z ich wytłumaczeniem.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 41%">
<col style="width: 37%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Zmienna</th>
<th style="text-align: center;">Opis</th>
<th style="text-align: center;">Jednostka</th>
<th style="text-align: center;">Typ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>age</code></td>
<td style="text-align: center;">Wiek (w latach)</td>
<td style="text-align: center;">Lata</td>
<td style="text-align: center;"><code>int</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>sex</code></td>
<td style="text-align: center;">Płeć (1 - Mężczyzna, 0 - Kobieta)</td>
<td style="text-align: center;">Brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>education</code></td>
<td style="text-align: center;"><p>Wykształcenie</p>
<p>(1 - Brak ukończonej szkoły średniej,</p>
<p>2 - Ukończona szkoła średnia,</p>
<p>3 - Nieukończone studia lub ukończona szkoła zawodowa,</p>
<p>4 - Wykształcenie Wyższe)</p></td>
<td style="text-align: center;">Brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>sysBP</code></td>
<td style="text-align: center;">Wartość ciśnienia skurczowego (Średnia ostatnich dwóch pomiarów)</td>
<td style="text-align: center;">mmHg</td>
<td style="text-align: center;"><code>numerical</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>diaBP</code></td>
<td style="text-align: center;">Wartość ciśnienia rozkurczowego (Średnia ostatnich dwóch pomiarów)</td>
<td style="text-align: center;">mmHg</td>
<td style="text-align: center;"><code>numerical</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>heartRate</code></td>
<td style="text-align: center;">Poziom tętna ()</td>
<td style="text-align: center;">Uderzeń na minutę</td>
<td style="text-align: center;"><code>int</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>BMI</code></td>
<td style="text-align: center;">Wartość współczynnika BMI</td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{\text{masa (kg)}}{\text{wzrost (m)}^2}\)</span></td>
<td style="text-align: center;"><code>float</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>totalChol</code></td>
<td style="text-align: center;">Wartość poziomu cholesterolu ()</td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{\text{mg}}{\text{dL}}\)</span></td>
<td style="text-align: center;"><code>int</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>glucose</code></td>
<td style="text-align: center;">Poziom glukozy we krwi ()</td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{\text{mg}}{\text{dL}}\)</span></td>
<td style="text-align: center;"><code>int</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>diabetes</code></td>
<td style="text-align: center;">Fakt czy pacjent jest cukrzykiem<br>
(1 - Tak, 0 - Nie)</td>
<td style="text-align: center;">brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>cigsPerDay</code></td>
<td style="text-align: center;">Średnia liczba palonych dziennie papierosów</td>
<td style="text-align: center;">sztuki</td>
<td style="text-align: center;"><code>int</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>currentSmoker</code></td>
<td style="text-align: center;">Fakt czy pacjent jest palaczem<br>
(1- Tak, 0 - Nie)</td>
<td style="text-align: center;">brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>BMPmeds</code></td>
<td style="text-align: center;">Fakt czy pacjent leczy się na nadciśnienie krwi (1 - Tak, 0 - Nie)</td>
<td style="text-align: center;">brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>prevalentStroke</code></td>
<td style="text-align: center;">Wskazuje czy pacjent przeżył udar mózgu. (1 - Tak, 0 - Nie)</td>
<td style="text-align: center;">brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>prevalentHyp</code></td>
<td style="text-align: center;">Wskazuje czy u pacjenta występowało nadciśnienie.<br>
(1 - Tak, 0 - Nie)</td>
<td style="text-align: center;">brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>TenYearCHD</code></td>
<td style="text-align: center;">Wskazuje 10-letnie ryzyko wystąpienia choroby wieńcowej u pacjenta.<br>
(1- Tak, 0-Nie)</td>
<td style="text-align: center;">brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
</tbody>
</table>
</section>
<section id="uzupełnienie-brakujących-wartości" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="uzupełnienie-brakujących-wartości"><span class="header-section-number">1.4</span> Uzupełnienie brakujących wartości</h3>
<p>Zastanówmy się co zrobić z brakami danych w naszym zbiorze badań. Przedstawmy ilość wartości <code>NA</code> dla każdej zmiennej, w której takie wartości wystepują.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>NA_count <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(badania))[<span class="fu">colSums</span>(<span class="fu">is.na</span>(badania)) <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(NA_count) <span class="ot">&lt;-</span> <span class="st">"count"</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>NA_count<span class="sc">$</span>var <span class="ot">=</span> <span class="fu">rownames</span>(NA_count)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(NA_count) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>NA_count <span class="ot">&lt;-</span> <span class="fu">select</span>(NA_count, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(NA_count, <span class="fu">aes</span>(<span class="at">x =</span> var, <span class="at">y =</span> count, <span class="at">fill =</span> <span class="st">"#fc9d03"</span>)) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> count), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">max</span>(NA_count<span class="sc">$</span>count) <span class="sc">*</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Liczba wartości NA w zmiennych"</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/na_count_before.png"</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/na_count_before.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Widzimy, że mamy kilka zmiennych, które zawierają braki danych. Liczby wartośći <code>NA</code> w poszczególnych kolumnach są zazwyczaj mniejsze lub równe około 100, jedynym wyjątkiem z aż 388 wartościami <code>NA</code> jest zmienna <code>glucose</code> oznaczająca poziom glukozy we krwi pacjenta. Zanim uzupełnimy braki danych odpowiednią techniką spróbujemy dowiedzieć się w jaki sposób rozkładają się wartości <code>NA</code> tzn. czy braki te wystepują u różnych pacjentów, czy też jeden pacjent posiada brak informacji w więcej niż tylko jednej zmiennej.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>NA_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">NA_w_wierszu =</span> <span class="fu">rowSums</span>(<span class="fu">is.na</span>(badania))) <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(NA_w_wierszu) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">liczebnosc =</span> <span class="fu">n</span>())</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> NA_df <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(NA_w_wierszu, liczebnosc, <span class="at">fill =</span> <span class="st">"#fc9d03"</span>)) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> liczebnosc), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">max</span>(NA_df<span class="sc">$</span>liczebnosc) <span class="sc">*</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Liczba wartości NA w rekordach"</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/NA_count_perRow.png"</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/NA_count.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Do uzupełniania wartości brakujących przyjeliśmy następującą metodykę:</p>
<ul>
<li><p>Rekordy posiadające dokładnie jedną wartość <code>NA</code> uzupełnimy na podstawie metody wielokrotnej imputacji</p></li>
<li><p>Rekordy posiadające więcej niż jedną wartość <code>NA</code> odrzucamy, aby nie bazować na znacznie brakujących danych</p></li>
</ul>
<p>W zmiennej <code>badania</code> wybieramy te wiersze, w których znajduje się co najwyżej jedna wartość <code>NA</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> badania[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(badania)) <span class="sc">&lt;=</span> <span class="dv">1</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wizualizacja liczby brakujących danych ma postać:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Po wczytaniu danych</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Po wstępnym usunięciu brakujących danych</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/na_count_before.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/na_count_after.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>W tym momencie przeprowadzimy proces uzupełniania zmiennych przy pomocy funkcji <code>mice</code> - metodą wielokrotnej imputacji. Braki danych znajdują się w kolumnach o różnych typach zmiennych.</p>
<p><strong>Zmienne kategoryczne:</strong></p>
<ul>
<li><p><code>BPMeds</code></p></li>
<li><p><code>education</code></p></li>
</ul>
<p><strong>Zmienne numeryczne:</strong></p>
<ul>
<li><p><code>BMI</code></p></li>
<li><p><code>cigsPerDay</code></p></li>
<li><p><code>glucose</code></p></li>
<li><p><code>heartRate</code></p></li>
<li><p><code>totChol</code></p></li>
</ul>
<p>Ze względu na typy zmiennych oraz rozkłady, jakimi te zmienne się charakteryzują decydujemy się użyć metodę <code>pmm</code> (Predictive Mean Matching) dla zmiennych numerycznych oraz metodę <code>logreg</code> dla <code>BPMeds</code> oraz <code>polr</code> dla <code>education</code>.</p>
<p><strong>Uzasadnienie:</strong> <code>pmm</code> zachowuje rozkłady i wybiera realne obserwacje jako wartości wejściowe, co jest szczególnie ważne przy zmiennych o rozkładzie ciągłym. Dla zmiennych kategorycznych używamy odpowiednich regresji klasyfikacyjnych w zależności od cech zmiennej.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>statystyki_przed <span class="ot">&lt;-</span> <span class="fu">describe</span>(badania[NA_count<span class="sc">$</span>var])</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>metody <span class="ot">&lt;-</span> <span class="fu">make.method</span>(badania)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"BPMeds"</span>] <span class="ot">&lt;-</span> <span class="st">"logreg"</span>        <span class="co">#</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"education"</span>] <span class="ot">&lt;-</span> <span class="st">"polr"</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"BMI"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"cigsPerDay"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"glucose"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"heartRate"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"totChol"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>uzupelnienia <span class="ot">&lt;-</span> <span class="fu">mice</span>(badania,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">m =</span> <span class="dv">5</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> metody,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">seed =</span> <span class="dv">2025</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> <span class="fu">complete</span>(uzupelnienia)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>statystyki_po <span class="ot">&lt;-</span> <span class="fu">describe</span>(badania[NA_count<span class="sc">$</span>var])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Po uzupełnieniu brakujących wartości porównajmy statystyki dla naszych zmiennych.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Przed uzupełnieniem danych</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Po uzupełnieniu danych</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(statystyki_przed))[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>), ], <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">education.</th>
<th style="text-align: right;">heartRate</th>
<th style="text-align: right;">BMI</th>
<th style="text-align: right;">totChol</th>
<th style="text-align: right;">glucose</th>
<th style="text-align: right;">cigsPerDay</th>
<th style="text-align: right;">BPMeds.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">n</td>
<td style="text-align: right;">4086.000</td>
<td style="text-align: right;">4178.000</td>
<td style="text-align: right;">4166.000</td>
<td style="text-align: right;">4170.000</td>
<td style="text-align: right;">3848.000</td>
<td style="text-align: right;">4156.000</td>
<td style="text-align: right;">4128.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">mean</td>
<td style="text-align: right;">1.980</td>
<td style="text-align: right;">75.876</td>
<td style="text-align: right;">25.798</td>
<td style="text-align: right;">236.726</td>
<td style="text-align: right;">81.962</td>
<td style="text-align: right;">8.982</td>
<td style="text-align: right;">1.029</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sd</td>
<td style="text-align: right;">1.020</td>
<td style="text-align: right;">12.035</td>
<td style="text-align: right;">4.080</td>
<td style="text-align: right;">44.660</td>
<td style="text-align: right;">23.962</td>
<td style="text-align: right;">11.912</td>
<td style="text-align: right;">0.168</td>
</tr>
<tr class="even">
<td style="text-align: left;">median</td>
<td style="text-align: right;">2.000</td>
<td style="text-align: right;">75.000</td>
<td style="text-align: right;">25.385</td>
<td style="text-align: right;">234.000</td>
<td style="text-align: right;">78.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trimmed</td>
<td style="text-align: right;">1.850</td>
<td style="text-align: right;">75.194</td>
<td style="text-align: right;">25.524</td>
<td style="text-align: right;">234.666</td>
<td style="text-align: right;">78.975</td>
<td style="text-align: right;">6.871</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">mad</td>
<td style="text-align: right;">1.483</td>
<td style="text-align: right;">10.378</td>
<td style="text-align: right;">3.684</td>
<td style="text-align: right;">42.995</td>
<td style="text-align: right;">11.861</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">min</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">44.000</td>
<td style="text-align: right;">15.540</td>
<td style="text-align: right;">107.000</td>
<td style="text-align: right;">40.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">max</td>
<td style="text-align: right;">4.000</td>
<td style="text-align: right;">143.000</td>
<td style="text-align: right;">56.800</td>
<td style="text-align: right;">696.000</td>
<td style="text-align: right;">394.000</td>
<td style="text-align: right;">70.000</td>
<td style="text-align: right;">2.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">range</td>
<td style="text-align: right;">3.000</td>
<td style="text-align: right;">99.000</td>
<td style="text-align: right;">41.260</td>
<td style="text-align: right;">589.000</td>
<td style="text-align: right;">354.000</td>
<td style="text-align: right;">70.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">skew</td>
<td style="text-align: right;">0.688</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">0.991</td>
<td style="text-align: right;">0.870</td>
<td style="text-align: right;">6.211</td>
<td style="text-align: right;">1.251</td>
<td style="text-align: right;">5.604</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kurtosis</td>
<td style="text-align: right;">-0.718</td>
<td style="text-align: right;">0.914</td>
<td style="text-align: right;">2.687</td>
<td style="text-align: right;">4.107</td>
<td style="text-align: right;">58.585</td>
<td style="text-align: right;">1.038</td>
<td style="text-align: right;">29.414</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(statystyki_po))[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>), ], <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">education.</th>
<th style="text-align: right;">heartRate</th>
<th style="text-align: right;">BMI</th>
<th style="text-align: right;">totChol</th>
<th style="text-align: right;">glucose</th>
<th style="text-align: right;">cigsPerDay</th>
<th style="text-align: right;">BPMeds.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">n</td>
<td style="text-align: right;">4179.000</td>
<td style="text-align: right;">4179.000</td>
<td style="text-align: right;">4179.000</td>
<td style="text-align: right;">4179.000</td>
<td style="text-align: right;">4179.000</td>
<td style="text-align: right;">4179.000</td>
<td style="text-align: right;">4179.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">mean</td>
<td style="text-align: right;">1.978</td>
<td style="text-align: right;">75.872</td>
<td style="text-align: right;">25.802</td>
<td style="text-align: right;">236.748</td>
<td style="text-align: right;">81.817</td>
<td style="text-align: right;">9.029</td>
<td style="text-align: right;">1.029</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sd</td>
<td style="text-align: right;">1.020</td>
<td style="text-align: right;">12.036</td>
<td style="text-align: right;">4.080</td>
<td style="text-align: right;">44.681</td>
<td style="text-align: right;">23.749</td>
<td style="text-align: right;">11.913</td>
<td style="text-align: right;">0.167</td>
</tr>
<tr class="even">
<td style="text-align: left;">median</td>
<td style="text-align: right;">2.000</td>
<td style="text-align: right;">75.000</td>
<td style="text-align: right;">25.400</td>
<td style="text-align: right;">234.000</td>
<td style="text-align: right;">78.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trimmed</td>
<td style="text-align: right;">1.848</td>
<td style="text-align: right;">75.190</td>
<td style="text-align: right;">25.529</td>
<td style="text-align: right;">234.678</td>
<td style="text-align: right;">78.917</td>
<td style="text-align: right;">6.928</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">mad</td>
<td style="text-align: right;">1.483</td>
<td style="text-align: right;">10.378</td>
<td style="text-align: right;">3.692</td>
<td style="text-align: right;">42.995</td>
<td style="text-align: right;">11.861</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">min</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">44.000</td>
<td style="text-align: right;">15.540</td>
<td style="text-align: right;">107.000</td>
<td style="text-align: right;">40.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">range</td>
<td style="text-align: right;">3.000</td>
<td style="text-align: right;">99.000</td>
<td style="text-align: right;">41.260</td>
<td style="text-align: right;">589.000</td>
<td style="text-align: right;">354.000</td>
<td style="text-align: right;">70.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">skew</td>
<td style="text-align: right;">0.691</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">0.986</td>
<td style="text-align: right;">0.870</td>
<td style="text-align: right;">6.397</td>
<td style="text-align: right;">1.241</td>
<td style="text-align: right;">5.642</td>
</tr>
<tr class="even">
<td style="text-align: left;">kurtosis</td>
<td style="text-align: right;">-0.715</td>
<td style="text-align: right;">0.913</td>
<td style="text-align: right;">2.672</td>
<td style="text-align: right;">4.092</td>
<td style="text-align: right;">62.373</td>
<td style="text-align: right;">1.011</td>
<td style="text-align: right;">29.839</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Sprawdzając podstawowe statystki widzimy, że uzupełniając dane zachowaliśmy ich strukturę. Różnica pomiędzy wartościami statystyk polega najczęściej na zmianie części tysięcznych lub setnych, więc wartości <code>NA</code> zostały bardzo dobrze odwzorowane. Teraz możemy zrobić analizę wstępną naszego zbioru danych, aby następnie przejść do stworzenia modeli predykcyjnych oraz głębszej analizy.</p>
</section>
<section id="wstępna-analiza" class="level3" data-number="1.5">
<h3 data-number="1.5" class="anchored" data-anchor-id="wstępna-analiza"><span class="header-section-number">1.5</span> Wstępna Analiza</h3>
<section id="statystyki" class="level4" data-number="1.5.1">
<h4 data-number="1.5.1" class="anchored" data-anchor-id="statystyki"><span class="header-section-number">1.5.1</span> Statystyki</h4>
</section>
<section id="funkcja-tworzenia-wykresów" class="level4" data-number="1.5.2">
<h4 data-number="1.5.2" class="anchored" data-anchor-id="funkcja-tworzenia-wykresów"><span class="header-section-number">1.5.2</span> Funkcja tworzenia wykresów</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>zmienna_wykres <span class="ot">&lt;-</span> <span class="cf">function</span>(dane, typ_zmiennej, typ_wykresu) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  my_plots <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (typ_zmiennej <span class="sc">==</span> <span class="st">"kategoryczna"</span>) {</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    dane <span class="ot">&lt;-</span> dane <span class="sc">|&gt;</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.factor))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (typ_zmiennej <span class="sc">==</span> <span class="st">"numeryczna"</span>) {</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    dane <span class="ot">&lt;-</span> dane <span class="sc">|&gt;</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># nic nie robimy</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(dane)) {</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    kolumna <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dane)[i]</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"barplot"</span>) {</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna), <span class="at">fill =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna))) <span class="sc">+</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(kolumna) <span class="sc">+</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>))</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"pie"</span>) {</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> dane <span class="sc">%&gt;%</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(<span class="sc">!!</span><span class="fu">sym</span>(kolumna)) <span class="sc">%&gt;%</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> n, <span class="at">fill =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna))) <span class="sc">+</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(kolumna) <span class="sc">+</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>))</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"histogram"</span>) {</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna))) <span class="sc">+</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(kolumna)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"violin"</span>) {</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna), <span class="at">fill =</span> <span class="st">"#6AAED9"</span>)) <span class="sc">+</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_violin</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(kolumna) <span class="sc">+</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>))</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span>  <span class="co"># pomiń jeśli nieznany typ wykresu</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>    my_plots[[i]] <span class="ot">&lt;-</span> p</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>gotowy_wykres_1 <span class="ot">&lt;-</span> (my_plots[[<span class="dv">1</span>]] <span class="sc">+</span> my_plots[[<span class="dv">2</span>]]) <span class="sc">/</span> (my_plots[[<span class="dv">3</span>]] <span class="sc">+</span> my_plots[[<span class="dv">4</span>]]) </span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>gotowy_wykres_2 <span class="ot">&lt;-</span> (my_plots[[<span class="dv">5</span>]] <span class="sc">+</span> my_plots[[<span class="dv">6</span>]]) <span class="sc">/</span> (my_plots[[<span class="dv">7</span>]] <span class="sc">+</span> my_plots[[<span class="dv">8</span>]])</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"images/plots/"</span>, typ_zmiennej, <span class="st">"_"</span>, typ_wykresu, <span class="st">"1.png"</span>), gotowy_wykres_1)</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"images/plots/"</span>, typ_zmiennej, <span class="st">"_"</span>, typ_wykresu, <span class="st">"2.png"</span>), gotowy_wykres_2)</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Tak zbudowana funkcja pozwala nam na generowanie wykresów w zależności od:</p>
<ul>
<li><p>Typu zmiennej</p></li>
<li><p>Typu wykresu</p></li>
</ul>
<p>Dzięki temu możemy szybko i prosto uzyskać wiele wizualizacji na temat interesujących nas zmiennych. Zdecydowaliśmy się przedstawić nasze zmienne z podziałem na:</p>
<ol type="1">
<li>Zmienne typu kategorycznego, przedstawiając liczebność ogólną oraz względem siebie, za pomocą wykresów <code>barplot</code> oraz <code>pie</code>.</li>
</ol>
<!-- -->
<ol start="2" type="1">
<li>Zmienne typu numerycznego, przedstawiając gęstośc oraz rozkład zmiennej, za pomocą wykresów <code>violin</code> oraz <code>histogram</code></li>
</ol>
<p>Poniżej przedstawiamy efekty naszej pracy, gdzie przeanalizujemy poszczególne zmienne.</p>
</section>
<section id="zmienne-kategoryczne" class="level4" data-number="1.5.3">
<h4 data-number="1.5.3" class="anchored" data-anchor-id="zmienne-kategoryczne"><span class="header-section-number">1.5.3</span> Zmienne Kategoryczne</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"kategoryczna"</span>, <span class="st">"barplot"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"kategoryczna"</span>, <span class="st">"pie"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Barplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Pie</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/kategoryczna_barplot1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/kategoryczna_barplot2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/kategoryczna_pie1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/kategoryczna_pie2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Po przeanalizowaniu wykresów nasuwają się nastepujące wnioski:</p>
<ul>
<li><p>Analizujemy zbiór ponad 4.000 osób, w którym kobiety lekko przewyższają swoją liczebnością mężczyzn.</p></li>
<li><p>Wraz z poziomem wykształcenia zmniejsza się liczba osób w danej kategorii wykształcenia. Osób bez ukończonej szkoły średniej jest około 1750, stopniowo zmniejszając się do 500 osób z wykształceniem wyższym. Wśród naszych danych przeważają osoby bez wykształcenia lub jedynie z wykształceniem średnim.</p></li>
<li><p>Podział na osoby palące i niepalące jest jednakowy. Obie grupy zawierają około 2.000 osób.</p></li>
<li><p>Grupy osób w których skład wchodzą osoby z cukrzycą, osoby leczące nadciśnienie krwi oraz osoby, które przeżyły udar mózgu są bardzo nieliczne. Ograniczają się maksymalnie do kilkudziesięciu osób. Mimo wszystko osoby te mogą dostarczyć wiele cennych informacji w dalszej analizie ryzyka choroby serca.</p></li>
<li><p>Bazujemy na danych w których stosunek liczby osób, u których nie występowało nadciśnienie do liczby osób u których nadciśnienie występowało jest równe w przybliżeniu 2:1.</p></li>
<li><p>Zmienna predykcyjna <code>TenYearCHD</code> przewiduje potencjalne ryzyko choroby serca dla ponad 500 osób, co stanowi około 12.5% liczby wszystkich badanych. Oznacza to, że średnio co 8 badana osoba jest kwalifikowana w grupie ryzyka.</p></li>
</ul>
</section>
<section id="zmienne-numeryczne" class="level4" data-number="1.5.4">
<h4 data-number="1.5.4" class="anchored" data-anchor-id="zmienne-numeryczne"><span class="header-section-number">1.5.4</span> Zmienne Numeryczne</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"numeryczna"</span>, <span class="st">"violin"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"numeryczna"</span>, <span class="st">"histogram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Violin</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Histogram</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/numeryczna_violin1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/numeryczna_violin2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/numeryczna_histogram1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/numeryczna_histogram2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Po przeanalizowaniu wykresów nasuwają się nastepujące wnioski:</p>
<ul>
<li><p>Badamy grupę osób, w której większość osób ma od 35 do 65 lat.</p></li>
<li><p>Ciśnienie rozkurczowe zawiera się głównie w przedziale &lt;70; 90&gt; natomiast ciśnienie skurczowe w przedziale &lt;115; 140&gt;</p></li>
<li><p>Najczęściej badane osoby posiadają tętno serca na poziomie 70-80 uderzeń na minutę.</p></li>
<li><p>Interesujący jest rozkład zmiennej <code>cigsPerDay</code>. Widać znaczący wzrost wystąpień osób palących 20 papierosów dziennie. Dokładnie taka liczba papierosów znajduje się w pojedyńczej paczce. Możemy zatem przyjąć, że dla wielu osób codziennym nawykiem jest wypalenie dokładnie całej paczki w trakcie dnia.</p></li>
<li><p>Zmienne cechują się niesymetrycznym rozkładem, dodatkowo zaburzone są rozkłady dla zmiennej <code>age</code> oraz <code>cigsPerDay</code>.</p></li>
<li><p>Większość zmiennych jest prawostronnie asymetryczna, ciężko mówić o normalności rozkładów ze względu na obecność wartości odstających, które są powszechne wśród danych medycznych.</p></li>
</ul>
</section>
<section id="zależności-pomiędzy-zmiennymi" class="level4" data-number="1.5.5">
<h4 data-number="1.5.5" class="anchored" data-anchor-id="zależności-pomiędzy-zmiennymi"><span class="header-section-number">1.5.5</span> Zależności pomiędzy zmiennymi</h4>
<p>Wśród naszych zmiennych mogą istnieć zależności liniowe. W celu sprawdzenia tego faktu stworzymy macierz korelacji, aby przedstawić jak wygląda korelacja pomiędzy poszczególnymi zmiennymi. Posłużymy się w tym celu zmiennymi numerycznymi.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>cor_mat <span class="ot">&lt;-</span> badania <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    cor_mat,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab =</span> <span class="cn">TRUE</span>,               </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"lower"</span>,           </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">hc.order =</span> <span class="cn">TRUE</span>,          <span class="co">#</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">outline.col =</span> <span class="st">"white"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ggtheme =</span> ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>(),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"white"</span>, <span class="st">"#F25041"</span>) </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/macierz_korelacji.jpg"</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/macierz_korelacji.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Widzimy, że istnieje duża korelacja równa 0.78 pomiędzy zmiennymi <code>sysBP</code> oraz <code>diaBP</code>. Nie powinno nas to specjalnie dziwić, ponieważ wartość ciśnienia rozkurczowego ma bezpośredni wypływ na wartość ciśnienia skurczowego. Dodatkowo poziom BMI a co za tym idzie - nasza waga ma wpływ na wartośc ciśnienia rozkurczowego oraz skurczowego. W oczy może rzucić nam się również wartość korelacji na poziomie -0.19 między zmienną <code>age</code> oraz <code>cigsPerDay</code>, która oznacza, że wraz z wiekiem palimy coraz mniej papierosów dziennie. Nie są to jednak wysokie wartości współczynnika korelacji, więc nie możemy powiedzieć, że pomiędzy tymi zmiennymi istnieje statystycznie istotna korelacja. Możemy jedna informacje traktować jako wskazówki podczas dalszej analizy i zgłębić analizę w kierunku tych zmiennych.</p>
</section>
<section id="relacja-pomiędzy-diabp-oraz-sysbp" class="level4" data-number="1.5.6">
<h4 data-number="1.5.6" class="anchored" data-anchor-id="relacja-pomiędzy-diabp-oraz-sysbp"><span class="header-section-number">1.5.6</span> Relacja pomiędzy <code>diaBP</code> oraz <code>sysBP</code></h4>
<p>Sprawdźmy jak będzie wyglądać zestawienie wartości ciśnienia skurczowego od wartości ciśnienia rozkurczowego, dodatkowo dodamy kilka czynników, które dotakowo pokażą zależności pomiędzy większą liczbą zmiennych.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">y =</span> sysBP, <span class="at">color =</span> sex, <span class="at">shape =</span> sex)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"sysBP ~ diaBP"</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">y =</span> sysBP, <span class="at">color =</span> education, <span class="at">shape =</span> education)) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"sysBP ~ diaBP"</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">y =</span> sysBP, <span class="at">color =</span> currentSmoker, <span class="at">shape =</span> currentSmoker)) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"sysBP ~ diaBP"</span>) <span class="sc">+</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysBP_diaBP_bySex.jpg"</span>, p1)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysBP_diaBP_byEducation.jpg"</span>, p2)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysBP_diaBP_byCurrentSmoker.jpg"</span>, p3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">f</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">fg</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">ghj</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/sysBP_diaBP_bySex.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/sysBP_diaBP_byEducation.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/sysBP_diaBP_byCurrentSmoker.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="relacja-pomiędzy-zmienną-age-a-zmienną-cigsperday" class="level3" data-number="1.6">
<h3 data-number="1.6" class="anchored" data-anchor-id="relacja-pomiędzy-zmienną-age-a-zmienną-cigsperday"><span class="header-section-number">1.6</span> Relacja pomiędzy zmienną <code>age</code>, a zmienną <code>cigsPerDay</code></h3>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/article/to_use/picture_2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="margin-top: 25px;"></p>
</figure>
</div>
</div>


<!-- -->

</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./plan.html" class="pagination-link" aria-label="1. Plan Projektu">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">1. Plan Projektu</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./wizualizacje.html" class="pagination-link" aria-label="3. Wizualizacje">
        <span class="nav-page-text">3. Wizualizacje</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb24" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Wczesne Wykrywanie Ryzyka Zawału Serca"</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Zapoznanie I Praca Z Danymi"</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="an">warning:</span><span class="co"> false</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rozpoczęcie</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>Lorem ipsum dolor sit amet consectetur adipiscing elit quisque faucibus ex sapien vitae pellentesque sem placerat in id cursus mi pretium tellus duis convallis tempus leo eu aenean sed diam urna tempor pulvinar vivamus fringilla lacus nec metus bibendum egestas iaculis massa nisl malesuada lacinia integer nunc posuere ut hendrerit semper vel class aptent taciti sociosqu ad litora torquent per conubia nostra inceptos himenaeos orci varius natoque penatibus et magnis dis parturient montes nascetur ridiculus mus donec rhoncus eros lobortis nulla molestie mattis scelerisque maximus eget fermentum odio phasellus non purus est efficitur laoreet mauris pharetra vestibulum fusce dictum risus blandit quis suspendisse aliquet nisi sodales consequat magna ante condimentum neque at luctus nibh finibus facilisis dapibus etiam interdum tortor ligula congue sollicitudin erat viverra ac tincidunt nam porta elementum a enim euismod quam justo lectus commodo augue arcu dignissim velit aliquam imperdiet mollis nullam volutpat porttitor ullamcorper rutrum gravida cras eleifend turpis fames primis vulputate ornare sagittis vehicula praesent dui felis.</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">### Biblioteki</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zapoznanie z danymi</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>Wczytanie pliku z rozszerzeniem <span class="in">`csv`</span> do zmiennej o nazwie <span class="in">`data`</span>.</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">"data/badania.csv"</span>, <span class="at">sep=</span><span class="st">","</span>)</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>Sprawdźmy jak wyglądają nasze dane. Użyjemy do tego funkcji <span class="in">`head()`</span> oraz <span class="in">`tail()`</span> do podglądu kilku pierwszych i ostatnich obserwacji w naszym zbiorze danych. Pierwsze 10 obserwacji ma postać:</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>Natomiast kilka ostatnich obserwcji nad którymi bedziemy pracować mają postać:</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(data)</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>Spradźmy rozmiary naszej ramki danych. W tym celu posłużymy się funkcjami <span class="in">`nrow()`</span> oraz <span class="in">`ncol()`</span>, które zawracają odpowiednio **liczbę wierszy** oraz **liczbę kolumn**.</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data)</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(data)</span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>Widzimy że mamy ponad 4200 obserwacji i 16 zmiennych, które posłużą nam do stworzenia kilku modeli predykcyjnych i wyboru tego, który najlepiej będzie oceniał ryzyko zawału serca. Jest to naprawdę duży zasób danych, które mogą odpowiedzieć na wiele interesujących pytań. Nadszedł czas sprawdzić zmienne, które posiadamy. Użyjemy do tego funkcji <span class="in">`colnames().`</span></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data)</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>Okazuje się, że nasz zbiór zawiera cenne informacje medyczne takie jak:</span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Tętno</span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>BMI</span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Ciśnienie skurczowe i rozkurczowe</span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Poziom cholesterolu i glukozy</span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Informacje o tym, czy pacjent był palaczem, czy też nie</span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>Dokładniej przyjrzymy się naszym zmiennym w dalszej części analizy zbioru danych. Wyjaśnimy dokładniej cechy poszczególnych kolumn zbioru danych oraz ich podstawowe statystyki. Czas sprawdzić podstawowe statystki dotyczące danych oraz to z jakimi typami danych będziemy pracować.</span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(data)</span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>Tak jak widać na powyższym raporcie, zaczytując dane otrzymujemy 3 zmienne typu <span class="in">`character`</span> oraz 13 zmiennych typu <span class="in">`numeric`</span>. Taki podział ze względu na typ zmiennych nie jest odpowiedni. Wszystkie cechy typu <span class="in">`character`</span> mają w naszym przypadku błędne formatowanie. Dodatkowo będziemy musieli dodać nowe typy zmiennych takie jak <span class="in">`boolean`</span> oraz <span class="in">`factor`</span>, aby móc szybko i praktycznie pracować z danymi. Odpowiedni wybór typów zmiennych jest podstawowym krokiem rozpczynając analizę zbioru danych. Zrobimy to w następujący sposób.</span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>badania_sorted <span class="sc">\&lt;</span>- badania<span class="sc">\[</span>order(is.na(badania\$glucose), decreasing = TRUE), <span class="sc">\]</span></span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">sysBP =</span> <span class="fu">as.numeric</span>(sysBP),</span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">diaBP =</span> <span class="fu">as.numeric</span>(diaBP),</span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">BMI =</span> <span class="fu">as.numeric</span>(BMI),</span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">factor</span>(male, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>)),</span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">education =</span> <span class="fu">factor</span>(education, <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">currentSmoker =</span> <span class="fu">factor</span>(currentSmoker, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">BPMeds =</span> <span class="fu">factor</span>(BPMeds, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">prevalentStroke =</span> <span class="fu">factor</span>(prevalentStroke, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">prevalentHyp =</span> <span class="fu">factor</span>(prevalentHyp, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">diabetes =</span> <span class="fu">factor</span>(diabetes, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">TenYearCHD =</span> <span class="fu">factor</span>(TenYearCHD, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>))</span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>male)   </span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> badania[<span class="fu">order</span>(<span class="fu">is.na</span>(badania<span class="sc">$</span>glucose), <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a>W tym momencie wszystkie zmienne mają przypisane odpowiednie typy danych, co pozwoli zaoszczędzić czas podczas przeprowadzania obliczeń i analizy nad nimi. Dla wygody uporządkujemy teraz kolumny w odpowiedniej dla nas kolejności, tak aby informacje powiązane ze sobą były obok siebie (Np. zmienna <span class="in">`glucose`</span> obok zmiennej <span class="in">`diabetes`</span>)</span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(badania, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>, <span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">14</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">15</span>))</span>
<span id="cb24-130"><a href="#cb24-130" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(badania)</span>
<span id="cb24-131"><a href="#cb24-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a>Zrobione. Teraz możemy przejść do wyjaśnienia zmiennych, aby było jasne z czym pracujemy oraz na czym możemy polegać podczas wykonywania analizy.</span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a><span class="fu">### Opis i wyjaśnienie zmiennych</span></span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a>Poniżej znajduje się tabela zawierająca wszystkie cechy wraz z ich wytłumaczeniem.</span>
<span id="cb24-138"><a href="#cb24-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-139"><a href="#cb24-139" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-140"><a href="#cb24-140" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Zmienna           <span class="pp">|</span> Opis                                                                 <span class="pp">|</span> Jednostka                                                    <span class="pp">|</span> Typ         <span class="pp">|</span></span>
<span id="cb24-141"><a href="#cb24-141" aria-hidden="true" tabindex="-1"></a>+:===============<span class="al">==:+:====================================================================:+:============================================================:+:==</span>=========:+</span>
<span id="cb24-142"><a href="#cb24-142" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`age`</span>             <span class="pp">|</span> Wiek (w latach)                                                      <span class="pp">|</span> Lata                                                         <span class="pp">|</span> <span class="in">`int`</span>       <span class="pp">|</span></span>
<span id="cb24-143"><a href="#cb24-143" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-144"><a href="#cb24-144" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`sex`</span>             <span class="pp">|</span> Płeć (1 - Mężczyzna, 0 - Kobieta)                                    <span class="pp">|</span> Brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb24-145"><a href="#cb24-145" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-146"><a href="#cb24-146" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`education`</span>       <span class="pp">|</span> Wykształcenie                                                        <span class="pp">|</span> Brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb24-147"><a href="#cb24-147" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span>                                                                      <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb24-148"><a href="#cb24-148" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> (1 - Brak ukończonej szkoły średniej,                                <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb24-149"><a href="#cb24-149" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span>                                                                      <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb24-150"><a href="#cb24-150" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> 2 - Ukończona szkoła średnia,                                        <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb24-151"><a href="#cb24-151" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span>                                                                      <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb24-152"><a href="#cb24-152" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> 3 - Nieukończone studia lub ukończona szkoła zawodowa,               <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb24-153"><a href="#cb24-153" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span>                                                                      <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb24-154"><a href="#cb24-154" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> 4 - Wykształcenie Wyższe)                                            <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb24-155"><a href="#cb24-155" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-156"><a href="#cb24-156" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`sysBP`</span>           <span class="pp">|</span> Wartość ciśnienia skurczowego (Średnia ostatnich dwóch pomiarów)     <span class="pp">|</span> mmHg                                                         <span class="pp">|</span> <span class="in">`numerical`</span> <span class="pp">|</span></span>
<span id="cb24-157"><a href="#cb24-157" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-158"><a href="#cb24-158" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`diaBP`</span>           <span class="pp">|</span> Wartość ciśnienia rozkurczowego (Średnia ostatnich dwóch pomiarów)   <span class="pp">|</span> mmHg                                                         <span class="pp">|</span> <span class="in">`numerical`</span> <span class="pp">|</span></span>
<span id="cb24-159"><a href="#cb24-159" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-160"><a href="#cb24-160" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`heartRate`</span>       <span class="pp">|</span> Poziom tętna ()                                                      <span class="pp">|</span> Uderzeń na minutę                                            <span class="pp">|</span> <span class="in">`int`</span>       <span class="pp">|</span></span>
<span id="cb24-161"><a href="#cb24-161" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-162"><a href="#cb24-162" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`BMI`</span>             <span class="pp">|</span> Wartość współczynnika BMI                                            <span class="pp">|</span> $\displaystyle \frac{\text{masa (kg)}}{\text{wzrost (m)}^2}$ <span class="pp">|</span> <span class="in">`float`</span>     <span class="pp">|</span></span>
<span id="cb24-163"><a href="#cb24-163" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-164"><a href="#cb24-164" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`totalChol`</span>       <span class="pp">|</span> Wartość poziomu cholesterolu ()                                      <span class="pp">|</span> $\displaystyle \frac{\text{mg}}{\text{dL}}$                  <span class="pp">|</span> <span class="in">`int`</span>       <span class="pp">|</span></span>
<span id="cb24-165"><a href="#cb24-165" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-166"><a href="#cb24-166" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`glucose`</span>         <span class="pp">|</span> Poziom glukozy we krwi ()                                            <span class="pp">|</span> $\displaystyle \frac{\text{mg}}{\text{dL}}$                  <span class="pp">|</span> <span class="in">`int`</span>       <span class="pp">|</span></span>
<span id="cb24-167"><a href="#cb24-167" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-168"><a href="#cb24-168" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`diabetes`</span>        <span class="pp">|</span> Fakt czy pacjent jest cukrzykiem\                                    <span class="pp">|</span> brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb24-169"><a href="#cb24-169" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> (1 - Tak, 0 - Nie)                                                   <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb24-170"><a href="#cb24-170" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-171"><a href="#cb24-171" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`cigsPerDay`</span>      <span class="pp">|</span> Średnia liczba palonych dziennie papierosów                          <span class="pp">|</span> sztuki                                                       <span class="pp">|</span> <span class="in">`int`</span>       <span class="pp">|</span></span>
<span id="cb24-172"><a href="#cb24-172" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-173"><a href="#cb24-173" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`currentSmoker`</span>   <span class="pp">|</span> Fakt czy pacjent jest palaczem\                                      <span class="pp">|</span> brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb24-174"><a href="#cb24-174" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> (1- Tak, 0 - Nie)                                                    <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb24-175"><a href="#cb24-175" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-176"><a href="#cb24-176" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`BMPmeds`</span>         <span class="pp">|</span> Fakt czy pacjent leczy się na nadciśnienie krwi (1 - Tak, 0 - Nie)   <span class="pp">|</span> brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb24-177"><a href="#cb24-177" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-178"><a href="#cb24-178" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`prevalentStroke`</span> <span class="pp">|</span> Wskazuje czy pacjent przeżył udar mózgu. (1 - Tak, 0 - Nie)          <span class="pp">|</span> brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb24-179"><a href="#cb24-179" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-180"><a href="#cb24-180" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`prevalentHyp`</span>    <span class="pp">|</span> Wskazuje czy u pacjenta występowało nadciśnienie.\                   <span class="pp">|</span> brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb24-181"><a href="#cb24-181" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> (1 - Tak, 0 - Nie)                                                   <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb24-182"><a href="#cb24-182" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-183"><a href="#cb24-183" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`TenYearCHD`</span>      <span class="pp">|</span> Wskazuje 10-letnie ryzyko wystąpienia choroby wieńcowej u pacjenta.\ <span class="pp">|</span> brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb24-184"><a href="#cb24-184" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> (1- Tak, 0-Nie)                                                      <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb24-185"><a href="#cb24-185" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb24-186"><a href="#cb24-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-187"><a href="#cb24-187" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uzupełnienie brakujących wartości</span></span>
<span id="cb24-188"><a href="#cb24-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-189"><a href="#cb24-189" aria-hidden="true" tabindex="-1"></a>Zastanówmy się co zrobić z brakami danych w naszym zbiorze badań. Przedstawmy ilość wartości <span class="in">`NA`</span> dla każdej zmiennej, w której takie wartości wystepują.</span>
<span id="cb24-190"><a href="#cb24-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-193"><a href="#cb24-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-194"><a href="#cb24-194" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb24-195"><a href="#cb24-195" aria-hidden="true" tabindex="-1"></a>NA_count <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(badania))[<span class="fu">colSums</span>(<span class="fu">is.na</span>(badania)) <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="sc">|&gt;</span> </span>
<span id="cb24-196"><a href="#cb24-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb24-197"><a href="#cb24-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-198"><a href="#cb24-198" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(NA_count) <span class="ot">&lt;-</span> <span class="st">"count"</span></span>
<span id="cb24-199"><a href="#cb24-199" aria-hidden="true" tabindex="-1"></a>NA_count<span class="sc">$</span>var <span class="ot">=</span> <span class="fu">rownames</span>(NA_count)</span>
<span id="cb24-200"><a href="#cb24-200" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(NA_count) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb24-201"><a href="#cb24-201" aria-hidden="true" tabindex="-1"></a>NA_count <span class="ot">&lt;-</span> <span class="fu">select</span>(NA_count, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb24-202"><a href="#cb24-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-203"><a href="#cb24-203" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(NA_count, <span class="fu">aes</span>(<span class="at">x =</span> var, <span class="at">y =</span> count, <span class="at">fill =</span> <span class="st">"#fc9d03"</span>)) <span class="sc">+</span></span>
<span id="cb24-204"><a href="#cb24-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-205"><a href="#cb24-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb24-206"><a href="#cb24-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> count), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb24-207"><a href="#cb24-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">max</span>(NA_count<span class="sc">$</span>count) <span class="sc">*</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb24-208"><a href="#cb24-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Liczba wartości NA w zmiennych"</span>)</span>
<span id="cb24-209"><a href="#cb24-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-210"><a href="#cb24-210" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/na_count_before.png"</span>, p)</span>
<span id="cb24-211"><a href="#cb24-211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-212"><a href="#cb24-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-213"><a href="#cb24-213" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/na_count_before.png)</span>{fig-align="center"}</span>
<span id="cb24-214"><a href="#cb24-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-215"><a href="#cb24-215" aria-hidden="true" tabindex="-1"></a>Widzimy, że mamy kilka zmiennych, które zawierają braki danych. Liczby wartośći <span class="in">`NA`</span> w poszczególnych kolumnach są zazwyczaj mniejsze lub równe około 100, jedynym wyjątkiem z aż 388 wartościami <span class="in">`NA`</span> jest zmienna <span class="in">`glucose`</span> oznaczająca poziom glukozy we krwi pacjenta. Zanim uzupełnimy braki danych odpowiednią techniką spróbujemy dowiedzieć się w jaki sposób rozkładają się wartości <span class="in">`NA`</span> tzn. czy braki te wystepują u różnych pacjentów, czy też jeden pacjent posiada brak informacji w więcej niż tylko jednej zmiennej.</span>
<span id="cb24-216"><a href="#cb24-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-219"><a href="#cb24-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-220"><a href="#cb24-220" aria-hidden="true" tabindex="-1"></a>NA_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">NA_w_wierszu =</span> <span class="fu">rowSums</span>(<span class="fu">is.na</span>(badania))) <span class="sc">|&gt;</span> </span>
<span id="cb24-221"><a href="#cb24-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(NA_w_wierszu) <span class="sc">|&gt;</span> </span>
<span id="cb24-222"><a href="#cb24-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">liczebnosc =</span> <span class="fu">n</span>())</span>
<span id="cb24-223"><a href="#cb24-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-224"><a href="#cb24-224" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> NA_df <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(NA_w_wierszu, liczebnosc, <span class="at">fill =</span> <span class="st">"#fc9d03"</span>)) <span class="sc">+</span></span>
<span id="cb24-225"><a href="#cb24-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-226"><a href="#cb24-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb24-227"><a href="#cb24-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> liczebnosc), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb24-228"><a href="#cb24-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">max</span>(NA_df<span class="sc">$</span>liczebnosc) <span class="sc">*</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb24-229"><a href="#cb24-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Liczba wartości NA w rekordach"</span>)</span>
<span id="cb24-230"><a href="#cb24-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-231"><a href="#cb24-231" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/NA_count_perRow.png"</span>, p)</span>
<span id="cb24-232"><a href="#cb24-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-233"><a href="#cb24-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-234"><a href="#cb24-234" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/NA_count.png)</span>{fig-align="center"}</span>
<span id="cb24-235"><a href="#cb24-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-236"><a href="#cb24-236" aria-hidden="true" tabindex="-1"></a>Do uzupełniania wartości brakujących przyjeliśmy następującą metodykę:</span>
<span id="cb24-237"><a href="#cb24-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-238"><a href="#cb24-238" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rekordy posiadające dokładnie jedną wartość <span class="in">`NA`</span> uzupełnimy na podstawie metody wielokrotnej imputacji</span>
<span id="cb24-239"><a href="#cb24-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-240"><a href="#cb24-240" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rekordy posiadające więcej niż jedną wartość <span class="in">`NA`</span> odrzucamy, aby nie bazować na znacznie brakujących danych</span>
<span id="cb24-241"><a href="#cb24-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-242"><a href="#cb24-242" aria-hidden="true" tabindex="-1"></a>W zmiennej <span class="in">`badania`</span> wybieramy te wiersze, w których znajduje się co najwyżej jedna wartość <span class="in">`NA`</span>.</span>
<span id="cb24-243"><a href="#cb24-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-246"><a href="#cb24-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-247"><a href="#cb24-247" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> badania[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(badania)) <span class="sc">&lt;=</span> <span class="dv">1</span>, ]</span>
<span id="cb24-248"><a href="#cb24-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-249"><a href="#cb24-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-252"><a href="#cb24-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-253"><a href="#cb24-253" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb24-254"><a href="#cb24-254" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-255"><a href="#cb24-255" aria-hidden="true" tabindex="-1"></a>NA_count <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(badania))[<span class="fu">colSums</span>(<span class="fu">is.na</span>(badania)) <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="sc">|&gt;</span> </span>
<span id="cb24-256"><a href="#cb24-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb24-257"><a href="#cb24-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-258"><a href="#cb24-258" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(NA_count) <span class="ot">&lt;-</span> <span class="st">"count"</span></span>
<span id="cb24-259"><a href="#cb24-259" aria-hidden="true" tabindex="-1"></a>NA_count<span class="sc">$</span>var <span class="ot">=</span> <span class="fu">rownames</span>(NA_count)</span>
<span id="cb24-260"><a href="#cb24-260" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(NA_count) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb24-261"><a href="#cb24-261" aria-hidden="true" tabindex="-1"></a>NA_count <span class="ot">&lt;-</span> <span class="fu">select</span>(NA_count, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb24-262"><a href="#cb24-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-263"><a href="#cb24-263" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(NA_count, <span class="fu">aes</span>(<span class="at">x =</span> var, <span class="at">y =</span> count, <span class="at">fill =</span> <span class="st">"#fc9d03"</span>)) <span class="sc">+</span></span>
<span id="cb24-264"><a href="#cb24-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-265"><a href="#cb24-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb24-266"><a href="#cb24-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> count), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb24-267"><a href="#cb24-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">max</span>(NA_count<span class="sc">$</span>count) <span class="sc">*</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb24-268"><a href="#cb24-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Liczba wartości NA w zmiennych"</span>)</span>
<span id="cb24-269"><a href="#cb24-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-270"><a href="#cb24-270" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/na_count_after.png"</span>, p)</span>
<span id="cb24-271"><a href="#cb24-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-272"><a href="#cb24-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-273"><a href="#cb24-273" aria-hidden="true" tabindex="-1"></a>Wizualizacja liczby brakujących danych ma postać:</span>
<span id="cb24-274"><a href="#cb24-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-275"><a href="#cb24-275" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb24-276"><a href="#cb24-276" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Po wczytaniu danych</span></span>
<span id="cb24-277"><a href="#cb24-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-278"><a href="#cb24-278" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/na_count_before.png)</span>{fig-align="center"}</span>
<span id="cb24-279"><a href="#cb24-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-280"><a href="#cb24-280" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Po wstępnym usunięciu brakujących danych</span></span>
<span id="cb24-281"><a href="#cb24-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-282"><a href="#cb24-282" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/na_count_after.png)</span>{fig-align="center"}</span>
<span id="cb24-283"><a href="#cb24-283" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb24-284"><a href="#cb24-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-285"><a href="#cb24-285" aria-hidden="true" tabindex="-1"></a>W tym momencie przeprowadzimy proces uzupełniania zmiennych przy pomocy funkcji <span class="in">`mice`</span> - metodą wielokrotnej imputacji. Braki danych znajdują się w kolumnach o różnych typach zmiennych.</span>
<span id="cb24-286"><a href="#cb24-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-287"><a href="#cb24-287" aria-hidden="true" tabindex="-1"></a>**Zmienne kategoryczne:**</span>
<span id="cb24-288"><a href="#cb24-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-289"><a href="#cb24-289" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`BPMeds`</span></span>
<span id="cb24-290"><a href="#cb24-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-291"><a href="#cb24-291" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`education`</span></span>
<span id="cb24-292"><a href="#cb24-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-293"><a href="#cb24-293" aria-hidden="true" tabindex="-1"></a>**Zmienne numeryczne:**</span>
<span id="cb24-294"><a href="#cb24-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-295"><a href="#cb24-295" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`BMI`</span></span>
<span id="cb24-296"><a href="#cb24-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-297"><a href="#cb24-297" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`cigsPerDay`</span></span>
<span id="cb24-298"><a href="#cb24-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-299"><a href="#cb24-299" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`glucose`</span></span>
<span id="cb24-300"><a href="#cb24-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-301"><a href="#cb24-301" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`heartRate`</span></span>
<span id="cb24-302"><a href="#cb24-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-303"><a href="#cb24-303" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`totChol`</span></span>
<span id="cb24-304"><a href="#cb24-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-305"><a href="#cb24-305" aria-hidden="true" tabindex="-1"></a>Ze względu na typy zmiennych oraz rozkłady, jakimi te zmienne się charakteryzują decydujemy się użyć metodę <span class="in">`pmm`</span> (Predictive Mean Matching) dla zmiennych numerycznych oraz metodę <span class="in">`logreg`</span> dla <span class="in">`BPMeds`</span> oraz <span class="in">`polr`</span> dla <span class="in">`education`</span>.</span>
<span id="cb24-306"><a href="#cb24-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-307"><a href="#cb24-307" aria-hidden="true" tabindex="-1"></a>**Uzasadnienie:** <span class="in">`pmm`</span> zachowuje rozkłady i wybiera realne obserwacje jako wartości wejściowe, co jest szczególnie ważne przy zmiennych o rozkładzie ciągłym. Dla zmiennych kategorycznych używamy odpowiednich regresji klasyfikacyjnych w zależności od cech zmiennej.</span>
<span id="cb24-308"><a href="#cb24-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-311"><a href="#cb24-311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-312"><a href="#cb24-312" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb24-313"><a href="#cb24-313" aria-hidden="true" tabindex="-1"></a>statystyki_przed <span class="ot">&lt;-</span> <span class="fu">describe</span>(badania[NA_count<span class="sc">$</span>var])</span>
<span id="cb24-314"><a href="#cb24-314" aria-hidden="true" tabindex="-1"></a>metody <span class="ot">&lt;-</span> <span class="fu">make.method</span>(badania)</span>
<span id="cb24-315"><a href="#cb24-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-316"><a href="#cb24-316" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"BPMeds"</span>] <span class="ot">&lt;-</span> <span class="st">"logreg"</span>        <span class="co">#</span></span>
<span id="cb24-317"><a href="#cb24-317" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"education"</span>] <span class="ot">&lt;-</span> <span class="st">"polr"</span> </span>
<span id="cb24-318"><a href="#cb24-318" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"BMI"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb24-319"><a href="#cb24-319" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"cigsPerDay"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb24-320"><a href="#cb24-320" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"glucose"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb24-321"><a href="#cb24-321" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"heartRate"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb24-322"><a href="#cb24-322" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"totChol"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb24-323"><a href="#cb24-323" aria-hidden="true" tabindex="-1"></a>uzupelnienia <span class="ot">&lt;-</span> <span class="fu">mice</span>(badania,</span>
<span id="cb24-324"><a href="#cb24-324" aria-hidden="true" tabindex="-1"></a>                <span class="at">m =</span> <span class="dv">5</span>,</span>
<span id="cb24-325"><a href="#cb24-325" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> metody,</span>
<span id="cb24-326"><a href="#cb24-326" aria-hidden="true" tabindex="-1"></a>                <span class="at">seed =</span> <span class="dv">2025</span>)</span>
<span id="cb24-327"><a href="#cb24-327" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> <span class="fu">complete</span>(uzupelnienia)</span>
<span id="cb24-328"><a href="#cb24-328" aria-hidden="true" tabindex="-1"></a>statystyki_po <span class="ot">&lt;-</span> <span class="fu">describe</span>(badania[NA_count<span class="sc">$</span>var])</span>
<span id="cb24-329"><a href="#cb24-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-330"><a href="#cb24-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-331"><a href="#cb24-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-332"><a href="#cb24-332" aria-hidden="true" tabindex="-1"></a>Po uzupełnieniu brakujących wartości porównajmy statystyki dla naszych zmiennych.</span>
<span id="cb24-333"><a href="#cb24-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-334"><a href="#cb24-334" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb24-335"><a href="#cb24-335" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Przed uzupełnieniem danych</span></span>
<span id="cb24-336"><a href="#cb24-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-339"><a href="#cb24-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-340"><a href="#cb24-340" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(statystyki_przed))[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>), ], <span class="dv">3</span>)</span>
<span id="cb24-341"><a href="#cb24-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-342"><a href="#cb24-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-343"><a href="#cb24-343" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Po uzupełnieniu danych</span></span>
<span id="cb24-344"><a href="#cb24-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-347"><a href="#cb24-347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-348"><a href="#cb24-348" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(statystyki_po))[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>), ], <span class="dv">3</span>)</span>
<span id="cb24-349"><a href="#cb24-349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-350"><a href="#cb24-350" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb24-351"><a href="#cb24-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-352"><a href="#cb24-352" aria-hidden="true" tabindex="-1"></a>Sprawdzając podstawowe statystki widzimy, że uzupełniając dane zachowaliśmy ich strukturę. Różnica pomiędzy wartościami statystyk polega najczęściej na zmianie części tysięcznych lub setnych, więc wartości <span class="in">`NA`</span> zostały bardzo dobrze odwzorowane. Teraz możemy zrobić analizę wstępną naszego zbioru danych, aby następnie przejść do stworzenia modeli predykcyjnych oraz głębszej analizy.</span>
<span id="cb24-353"><a href="#cb24-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-354"><a href="#cb24-354" aria-hidden="true" tabindex="-1"></a><span class="fu">### Wstępna Analiza</span></span>
<span id="cb24-355"><a href="#cb24-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-356"><a href="#cb24-356" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Statystyki</span></span>
<span id="cb24-357"><a href="#cb24-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-360"><a href="#cb24-360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-361"><a href="#cb24-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-362"><a href="#cb24-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-363"><a href="#cb24-363" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Funkcja tworzenia wykresów</span></span>
<span id="cb24-364"><a href="#cb24-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-367"><a href="#cb24-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-368"><a href="#cb24-368" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb24-369"><a href="#cb24-369" aria-hidden="true" tabindex="-1"></a>zmienna_wykres <span class="ot">&lt;-</span> <span class="cf">function</span>(dane, typ_zmiennej, typ_wykresu) {</span>
<span id="cb24-370"><a href="#cb24-370" aria-hidden="true" tabindex="-1"></a>  my_plots <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb24-371"><a href="#cb24-371" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (typ_zmiennej <span class="sc">==</span> <span class="st">"kategoryczna"</span>) {</span>
<span id="cb24-372"><a href="#cb24-372" aria-hidden="true" tabindex="-1"></a>    dane <span class="ot">&lt;-</span> dane <span class="sc">|&gt;</span> </span>
<span id="cb24-373"><a href="#cb24-373" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.factor))</span>
<span id="cb24-374"><a href="#cb24-374" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (typ_zmiennej <span class="sc">==</span> <span class="st">"numeryczna"</span>) {</span>
<span id="cb24-375"><a href="#cb24-375" aria-hidden="true" tabindex="-1"></a>    dane <span class="ot">&lt;-</span> dane <span class="sc">|&gt;</span> </span>
<span id="cb24-376"><a href="#cb24-376" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb24-377"><a href="#cb24-377" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb24-378"><a href="#cb24-378" aria-hidden="true" tabindex="-1"></a>    <span class="co"># nic nie robimy</span></span>
<span id="cb24-379"><a href="#cb24-379" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-380"><a href="#cb24-380" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-381"><a href="#cb24-381" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(dane)) {</span>
<span id="cb24-382"><a href="#cb24-382" aria-hidden="true" tabindex="-1"></a>    kolumna <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dane)[i]</span>
<span id="cb24-383"><a href="#cb24-383" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"barplot"</span>) {</span>
<span id="cb24-384"><a href="#cb24-384" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna), <span class="at">fill =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna))) <span class="sc">+</span></span>
<span id="cb24-385"><a href="#cb24-385" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-386"><a href="#cb24-386" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb24-387"><a href="#cb24-387" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(kolumna) <span class="sc">+</span></span>
<span id="cb24-388"><a href="#cb24-388" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>))</span>
<span id="cb24-389"><a href="#cb24-389" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb24-390"><a href="#cb24-390" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-391"><a href="#cb24-391" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"pie"</span>) {</span>
<span id="cb24-392"><a href="#cb24-392" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> dane <span class="sc">%&gt;%</span></span>
<span id="cb24-393"><a href="#cb24-393" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(<span class="sc">!!</span><span class="fu">sym</span>(kolumna)) <span class="sc">%&gt;%</span></span>
<span id="cb24-394"><a href="#cb24-394" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> n, <span class="at">fill =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna))) <span class="sc">+</span></span>
<span id="cb24-395"><a href="#cb24-395" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb24-396"><a href="#cb24-396" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb24-397"><a href="#cb24-397" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb24-398"><a href="#cb24-398" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(kolumna) <span class="sc">+</span></span>
<span id="cb24-399"><a href="#cb24-399" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>))</span>
<span id="cb24-400"><a href="#cb24-400" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb24-401"><a href="#cb24-401" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"histogram"</span>) {</span>
<span id="cb24-402"><a href="#cb24-402" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna))) <span class="sc">+</span></span>
<span id="cb24-403"><a href="#cb24-403" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb24-404"><a href="#cb24-404" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb24-405"><a href="#cb24-405" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(kolumna)</span>
<span id="cb24-406"><a href="#cb24-406" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-407"><a href="#cb24-407" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb24-408"><a href="#cb24-408" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"violin"</span>) {</span>
<span id="cb24-409"><a href="#cb24-409" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna), <span class="at">fill =</span> <span class="st">"#6AAED9"</span>)) <span class="sc">+</span></span>
<span id="cb24-410"><a href="#cb24-410" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_violin</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-411"><a href="#cb24-411" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb24-412"><a href="#cb24-412" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(kolumna) <span class="sc">+</span></span>
<span id="cb24-413"><a href="#cb24-413" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>))</span>
<span id="cb24-414"><a href="#cb24-414" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb24-415"><a href="#cb24-415" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span>  <span class="co"># pomiń jeśli nieznany typ wykresu</span></span>
<span id="cb24-416"><a href="#cb24-416" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-417"><a href="#cb24-417" aria-hidden="true" tabindex="-1"></a>    my_plots[[i]] <span class="ot">&lt;-</span> p</span>
<span id="cb24-418"><a href="#cb24-418" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb24-419"><a href="#cb24-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-420"><a href="#cb24-420" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-421"><a href="#cb24-421" aria-hidden="true" tabindex="-1"></a>gotowy_wykres_1 <span class="ot">&lt;-</span> (my_plots[[<span class="dv">1</span>]] <span class="sc">+</span> my_plots[[<span class="dv">2</span>]]) <span class="sc">/</span> (my_plots[[<span class="dv">3</span>]] <span class="sc">+</span> my_plots[[<span class="dv">4</span>]]) </span>
<span id="cb24-422"><a href="#cb24-422" aria-hidden="true" tabindex="-1"></a>gotowy_wykres_2 <span class="ot">&lt;-</span> (my_plots[[<span class="dv">5</span>]] <span class="sc">+</span> my_plots[[<span class="dv">6</span>]]) <span class="sc">/</span> (my_plots[[<span class="dv">7</span>]] <span class="sc">+</span> my_plots[[<span class="dv">8</span>]])</span>
<span id="cb24-423"><a href="#cb24-423" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"images/plots/"</span>, typ_zmiennej, <span class="st">"_"</span>, typ_wykresu, <span class="st">"1.png"</span>), gotowy_wykres_1)</span>
<span id="cb24-424"><a href="#cb24-424" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"images/plots/"</span>, typ_zmiennej, <span class="st">"_"</span>, typ_wykresu, <span class="st">"2.png"</span>), gotowy_wykres_2)</span>
<span id="cb24-425"><a href="#cb24-425" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-426"><a href="#cb24-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-427"><a href="#cb24-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-428"><a href="#cb24-428" aria-hidden="true" tabindex="-1"></a>Tak zbudowana funkcja pozwala nam na generowanie wykresów w zależności od:</span>
<span id="cb24-429"><a href="#cb24-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-430"><a href="#cb24-430" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Typu zmiennej</span>
<span id="cb24-431"><a href="#cb24-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-432"><a href="#cb24-432" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Typu wykresu</span>
<span id="cb24-433"><a href="#cb24-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-434"><a href="#cb24-434" aria-hidden="true" tabindex="-1"></a>Dzięki temu możemy szybko i prosto uzyskać wiele wizualizacji na temat interesujących nas zmiennych. Zdecydowaliśmy się przedstawić nasze zmienne z podziałem na:</span>
<span id="cb24-435"><a href="#cb24-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-436"><a href="#cb24-436" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Zmienne typu kategorycznego, przedstawiając liczebność ogólną oraz względem siebie, za pomocą wykresów <span class="in">`barplot`</span> oraz <span class="in">`pie`</span>.</span>
<span id="cb24-437"><a href="#cb24-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-438"><a href="#cb24-438" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb24-439"><a href="#cb24-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-440"><a href="#cb24-440" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Zmienne typu numerycznego, przedstawiając gęstośc oraz rozkład zmiennej, za pomocą wykresów <span class="in">`violin`</span> oraz <span class="in">`histogram`</span></span>
<span id="cb24-441"><a href="#cb24-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-442"><a href="#cb24-442" aria-hidden="true" tabindex="-1"></a>Poniżej przedstawiamy efekty naszej pracy, gdzie przeanalizujemy poszczególne zmienne.</span>
<span id="cb24-443"><a href="#cb24-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-444"><a href="#cb24-444" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zmienne Kategoryczne</span></span>
<span id="cb24-445"><a href="#cb24-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-448"><a href="#cb24-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-449"><a href="#cb24-449" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"kategoryczna"</span>, <span class="st">"barplot"</span>)</span>
<span id="cb24-450"><a href="#cb24-450" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"kategoryczna"</span>, <span class="st">"pie"</span>)</span>
<span id="cb24-451"><a href="#cb24-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-452"><a href="#cb24-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-453"><a href="#cb24-453" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb24-454"><a href="#cb24-454" aria-hidden="true" tabindex="-1"></a><span class="fu">## Barplot</span></span>
<span id="cb24-455"><a href="#cb24-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-456"><a href="#cb24-456" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/kategoryczna_barplot1.png)</span>{fig-align="center"}</span>
<span id="cb24-457"><a href="#cb24-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-458"><a href="#cb24-458" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/kategoryczna_barplot2.png)</span>{fig-align="center"}</span>
<span id="cb24-459"><a href="#cb24-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-460"><a href="#cb24-460" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pie</span></span>
<span id="cb24-461"><a href="#cb24-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-462"><a href="#cb24-462" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/kategoryczna_pie1.png)</span>{fig-align="center"}</span>
<span id="cb24-463"><a href="#cb24-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-464"><a href="#cb24-464" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/kategoryczna_pie2.png)</span>{fig-align="center"}</span>
<span id="cb24-465"><a href="#cb24-465" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb24-466"><a href="#cb24-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-467"><a href="#cb24-467" aria-hidden="true" tabindex="-1"></a>Po przeanalizowaniu wykresów nasuwają się nastepujące wnioski:</span>
<span id="cb24-468"><a href="#cb24-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-469"><a href="#cb24-469" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Analizujemy zbiór ponad 4.000 osób, w którym kobiety lekko przewyższają swoją liczebnością mężczyzn.</span>
<span id="cb24-470"><a href="#cb24-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-471"><a href="#cb24-471" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wraz z poziomem wykształcenia zmniejsza się liczba osób w danej kategorii wykształcenia. Osób bez ukończonej szkoły średniej jest około 1750, stopniowo zmniejszając się do 500 osób z wykształceniem wyższym. Wśród naszych danych przeważają osoby bez wykształcenia lub jedynie z wykształceniem średnim.</span>
<span id="cb24-472"><a href="#cb24-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-473"><a href="#cb24-473" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Podział na osoby palące i niepalące jest jednakowy. Obie grupy zawierają około 2.000 osób.</span>
<span id="cb24-474"><a href="#cb24-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-475"><a href="#cb24-475" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Grupy osób w których skład wchodzą osoby z cukrzycą, osoby leczące nadciśnienie krwi oraz osoby, które przeżyły udar mózgu są bardzo nieliczne. Ograniczają się maksymalnie do kilkudziesięciu osób. Mimo wszystko osoby te mogą dostarczyć wiele cennych informacji w dalszej analizie ryzyka choroby serca.</span>
<span id="cb24-476"><a href="#cb24-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-477"><a href="#cb24-477" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bazujemy na danych w których stosunek liczby osób, u których nie występowało nadciśnienie do liczby osób u których nadciśnienie występowało jest równe w przybliżeniu 2:1.</span>
<span id="cb24-478"><a href="#cb24-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-479"><a href="#cb24-479" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Zmienna predykcyjna <span class="in">`TenYearCHD`</span> przewiduje potencjalne ryzyko choroby serca dla ponad 500 osób, co stanowi około 12.5% liczby wszystkich badanych. Oznacza to, że średnio co 8 badana osoba jest kwalifikowana w grupie ryzyka.</span>
<span id="cb24-480"><a href="#cb24-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-481"><a href="#cb24-481" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zmienne Numeryczne</span></span>
<span id="cb24-482"><a href="#cb24-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-485"><a href="#cb24-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-486"><a href="#cb24-486" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"numeryczna"</span>, <span class="st">"violin"</span>)</span>
<span id="cb24-487"><a href="#cb24-487" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"numeryczna"</span>, <span class="st">"histogram"</span>)</span>
<span id="cb24-488"><a href="#cb24-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-489"><a href="#cb24-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-490"><a href="#cb24-490" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb24-491"><a href="#cb24-491" aria-hidden="true" tabindex="-1"></a><span class="fu">## Violin</span></span>
<span id="cb24-492"><a href="#cb24-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-493"><a href="#cb24-493" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/numeryczna_violin1.png)</span>{fig-align="center"}</span>
<span id="cb24-494"><a href="#cb24-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-495"><a href="#cb24-495" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/numeryczna_violin2.png)</span>{fig-align="center"}</span>
<span id="cb24-496"><a href="#cb24-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-497"><a href="#cb24-497" aria-hidden="true" tabindex="-1"></a><span class="fu">## Histogram</span></span>
<span id="cb24-498"><a href="#cb24-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-499"><a href="#cb24-499" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/numeryczna_histogram1.png)</span>{fig-align="center"}</span>
<span id="cb24-500"><a href="#cb24-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-501"><a href="#cb24-501" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/numeryczna_histogram2.png)</span>{fig-align="center"}</span>
<span id="cb24-502"><a href="#cb24-502" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb24-503"><a href="#cb24-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-504"><a href="#cb24-504" aria-hidden="true" tabindex="-1"></a>Po przeanalizowaniu wykresów nasuwają się nastepujące wnioski:</span>
<span id="cb24-505"><a href="#cb24-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-506"><a href="#cb24-506" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Badamy grupę osób, w której większość osób ma od 35 do 65 lat.</span>
<span id="cb24-507"><a href="#cb24-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-508"><a href="#cb24-508" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ciśnienie rozkurczowe zawiera się głównie w przedziale <span class="sc">\&lt;</span>70; 90<span class="sc">\&gt;</span> natomiast ciśnienie skurczowe w przedziale <span class="sc">\&lt;</span>115; 140<span class="sc">\&gt;</span></span>
<span id="cb24-509"><a href="#cb24-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-510"><a href="#cb24-510" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Najczęściej badane osoby posiadają tętno serca na poziomie 70-80 uderzeń na minutę.</span>
<span id="cb24-511"><a href="#cb24-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-512"><a href="#cb24-512" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interesujący jest rozkład zmiennej <span class="in">`cigsPerDay`</span>. Widać znaczący wzrost wystąpień osób palących 20 papierosów dziennie. Dokładnie taka liczba papierosów znajduje się w pojedyńczej paczce. Możemy zatem przyjąć, że dla wielu osób codziennym nawykiem jest wypalenie dokładnie całej paczki w trakcie dnia.</span>
<span id="cb24-513"><a href="#cb24-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-514"><a href="#cb24-514" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Zmienne cechują się niesymetrycznym rozkładem, dodatkowo zaburzone są rozkłady dla zmiennej <span class="in">`age`</span> oraz <span class="in">`cigsPerDay`</span>.</span>
<span id="cb24-515"><a href="#cb24-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-516"><a href="#cb24-516" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Większość zmiennych jest prawostronnie asymetryczna, ciężko mówić o normalności rozkładów ze względu na obecność wartości odstających, które są powszechne wśród danych medycznych.</span>
<span id="cb24-517"><a href="#cb24-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-518"><a href="#cb24-518" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zależności pomiędzy zmiennymi</span></span>
<span id="cb24-519"><a href="#cb24-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-520"><a href="#cb24-520" aria-hidden="true" tabindex="-1"></a>Wśród naszych zmiennych mogą istnieć zależności liniowe. W celu sprawdzenia tego faktu stworzymy macierz korelacji, aby przedstawić jak wygląda korelacja pomiędzy poszczególnymi zmiennymi. Posłużymy się w tym celu zmiennymi numerycznymi.</span>
<span id="cb24-521"><a href="#cb24-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-524"><a href="#cb24-524" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-525"><a href="#cb24-525" aria-hidden="true" tabindex="-1"></a>cor_mat <span class="ot">&lt;-</span> badania <span class="sc">%&gt;%</span> </span>
<span id="cb24-526"><a href="#cb24-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-527"><a href="#cb24-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span>
<span id="cb24-528"><a href="#cb24-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-529"><a href="#cb24-529" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(</span>
<span id="cb24-530"><a href="#cb24-530" aria-hidden="true" tabindex="-1"></a>    cor_mat,</span>
<span id="cb24-531"><a href="#cb24-531" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab =</span> <span class="cn">TRUE</span>,               </span>
<span id="cb24-532"><a href="#cb24-532" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"lower"</span>,           </span>
<span id="cb24-533"><a href="#cb24-533" aria-hidden="true" tabindex="-1"></a>    <span class="at">hc.order =</span> <span class="cn">TRUE</span>,          <span class="co">#</span></span>
<span id="cb24-534"><a href="#cb24-534" aria-hidden="true" tabindex="-1"></a>    <span class="at">outline.col =</span> <span class="st">"white"</span>,</span>
<span id="cb24-535"><a href="#cb24-535" aria-hidden="true" tabindex="-1"></a>    <span class="at">ggtheme =</span> ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>(),</span>
<span id="cb24-536"><a href="#cb24-536" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"white"</span>, <span class="st">"#F25041"</span>) </span>
<span id="cb24-537"><a href="#cb24-537" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-538"><a href="#cb24-538" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/macierz_korelacji.jpg"</span>, p)</span>
<span id="cb24-539"><a href="#cb24-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-540"><a href="#cb24-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-541"><a href="#cb24-541" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/macierz_korelacji.jpg)</span>{fig-align="center"}</span>
<span id="cb24-542"><a href="#cb24-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-543"><a href="#cb24-543" aria-hidden="true" tabindex="-1"></a>Widzimy, że istnieje duża korelacja równa 0.78 pomiędzy zmiennymi <span class="in">`sysBP`</span> oraz <span class="in">`diaBP`</span>. Nie powinno nas to specjalnie dziwić, ponieważ wartość ciśnienia rozkurczowego ma bezpośredni wypływ na wartość ciśnienia skurczowego. Dodatkowo poziom BMI a co za tym idzie - nasza waga ma wpływ na wartośc ciśnienia rozkurczowego oraz skurczowego. W oczy może rzucić nam się również wartość korelacji na poziomie -0.19 między zmienną <span class="in">`age`</span> oraz <span class="in">`cigsPerDay`</span>, która oznacza, że wraz z wiekiem palimy coraz mniej papierosów dziennie. Nie są to jednak wysokie wartości współczynnika korelacji, więc nie możemy powiedzieć, że pomiędzy tymi zmiennymi istnieje statystycznie istotna korelacja. Możemy jedna informacje traktować jako wskazówki podczas dalszej analizy i zgłębić analizę w kierunku tych zmiennych.</span>
<span id="cb24-544"><a href="#cb24-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-545"><a href="#cb24-545" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Relacja pomiędzy `diaBP` oraz `sysBP`</span></span>
<span id="cb24-546"><a href="#cb24-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-547"><a href="#cb24-547" aria-hidden="true" tabindex="-1"></a>Sprawdźmy jak będzie wyglądać zestawienie wartości ciśnienia skurczowego od wartości ciśnienia rozkurczowego, dodatkowo dodamy kilka czynników, które dotakowo pokażą zależności pomiędzy większą liczbą zmiennych.</span>
<span id="cb24-548"><a href="#cb24-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-551"><a href="#cb24-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-552"><a href="#cb24-552" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">y =</span> sysBP, <span class="at">color =</span> sex, <span class="at">shape =</span> sex)) <span class="sc">+</span></span>
<span id="cb24-553"><a href="#cb24-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb24-554"><a href="#cb24-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb24-555"><a href="#cb24-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"sysBP ~ diaBP"</span>) <span class="sc">+</span></span>
<span id="cb24-556"><a href="#cb24-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb24-557"><a href="#cb24-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb24-558"><a href="#cb24-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-559"><a href="#cb24-559" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">y =</span> sysBP, <span class="at">color =</span> education, <span class="at">shape =</span> education)) <span class="sc">+</span></span>
<span id="cb24-560"><a href="#cb24-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb24-561"><a href="#cb24-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb24-562"><a href="#cb24-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"sysBP ~ diaBP"</span>) <span class="sc">+</span></span>
<span id="cb24-563"><a href="#cb24-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb24-564"><a href="#cb24-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb24-565"><a href="#cb24-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-566"><a href="#cb24-566" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">y =</span> sysBP, <span class="at">color =</span> currentSmoker, <span class="at">shape =</span> currentSmoker)) <span class="sc">+</span></span>
<span id="cb24-567"><a href="#cb24-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb24-568"><a href="#cb24-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb24-569"><a href="#cb24-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"sysBP ~ diaBP"</span>) <span class="sc">+</span></span>
<span id="cb24-570"><a href="#cb24-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb24-571"><a href="#cb24-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb24-572"><a href="#cb24-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-573"><a href="#cb24-573" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysBP_diaBP_bySex.jpg"</span>, p1)</span>
<span id="cb24-574"><a href="#cb24-574" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysBP_diaBP_byEducation.jpg"</span>, p2)</span>
<span id="cb24-575"><a href="#cb24-575" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysBP_diaBP_byCurrentSmoker.jpg"</span>, p3)</span>
<span id="cb24-576"><a href="#cb24-576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-577"><a href="#cb24-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-578"><a href="#cb24-578" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb24-579"><a href="#cb24-579" aria-hidden="true" tabindex="-1"></a><span class="fu">### f</span></span>
<span id="cb24-580"><a href="#cb24-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-581"><a href="#cb24-581" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/sysBP_diaBP_bySex.jpg)</span>{fig-align="center"}</span>
<span id="cb24-582"><a href="#cb24-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-583"><a href="#cb24-583" aria-hidden="true" tabindex="-1"></a><span class="fu">### fg</span></span>
<span id="cb24-584"><a href="#cb24-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-585"><a href="#cb24-585" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/sysBP_diaBP_byEducation.jpg)</span>{fig-align="center"}</span>
<span id="cb24-586"><a href="#cb24-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-587"><a href="#cb24-587" aria-hidden="true" tabindex="-1"></a><span class="fu">### ghj</span></span>
<span id="cb24-588"><a href="#cb24-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-589"><a href="#cb24-589" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/sysBP_diaBP_byCurrentSmoker.jpg)</span>{fig-align="center"}</span>
<span id="cb24-590"><a href="#cb24-590" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb24-591"><a href="#cb24-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-592"><a href="#cb24-592" aria-hidden="true" tabindex="-1"></a><span class="fu">### Relacja pomiędzy zmienną `age`, a zmienną `cigsPerDay`</span></span>
<span id="cb24-593"><a href="#cb24-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-596"><a href="#cb24-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-597"><a href="#cb24-597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-598"><a href="#cb24-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-599"><a href="#cb24-599" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb24-600"><a href="#cb24-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-601"><a href="#cb24-601" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/article/to_use/picture_2.png)</span>{style="margin-top: 25px;" fig-align="center"}</span>
<span id="cb24-602"><a href="#cb24-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-603"><a href="#cb24-603" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 IAD III 2025
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Projekt z Zakresu Analizy Danych
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2025 Tomasz Golecki | Tomasz Hanusek | Damian Spodar
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>